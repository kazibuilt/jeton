"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8983],{45009:(e,t,i)=>{i.d(t,{W:()=>s});var a=i(49057),o=i(60484),n=i(84669);const s=()=>{const{language:e}=(0,o.L$)((0,a.W)((()=>["language"]),[]));return n.D.includes(e)}},64231:(e,t,i)=>{i.d(t,{i:()=>o});var a=i(40099);const o=({upHandler:e,downHandler:t,confirmHandler:i,tabHandler:o})=>(0,a.useCallback)((a=>{const{keyCode:n}=a;switch(n){case 38:a.preventDefault(),e();break;case 40:a.preventDefault(),t();break;case 13:null==i||i();break;case 9:null==o||o(a)}}),[i,t,o,e])},349:(e,t,i)=>{i.d(t,{gi:()=>Je});var a=i(24643),o=i(40099),n=i(47172),s=i(2913),r=i(16188),l=i(5412),c=i(8800),d=i(71111),u=i(31209),m=i(22220),h=i(18499),g=function(e,t,i,a){return new(i||(i=Promise))((function(o,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function r(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,r)}l((a=a.apply(e,t||[])).next())}))};const p=(0,d.atom)({keyword:"",loading:!1,isFetchError:!1,defaultResult:{list:[]},searchResult:{list:[],hasMore:!0,uidFilterList:""},activeList:[],activeItem:{index:null,isActivatedByMouse:!1},recentCount:0});p.debugLabel="mentionSuggestionUserAtom";const{useAtomService:j,useServiceDispatchers:b,useServiceState:v}=(0,u.i)(p,((e,t)=>({setKeyword(e){t(p,(t=>Object.assign(Object.assign({},t),{keyword:e})))},setLoading(e){t(p,(t=>Object.assign(Object.assign({},t),{loading:e})))},setFetchError(e){t(p,(t=>Object.assign(Object.assign({},t),{isFetchError:e,searchResult:Object.assign(Object.assign({},t.searchResult),{hasMore:!e&&t.searchResult.hasMore})})))},setActiveList(e){t(p,(t=>Object.assign(Object.assign({},t),{activeList:e})))},setActiveItem(e){const{index:i,isActivatedByMouse:a=!1}=e;t(p,(e=>Object.assign(Object.assign({},e),{activeItem:{index:i,isActivatedByMouse:a}})))},activePrev(){const{activeItem:i,activeList:a}=e(p),{index:o}=i;if(null===o)return;const{length:n}=a;0!==n&&t(p,(e=>Object.assign(Object.assign({},e),{activeItem:{index:Math.max(0,o-1),isActivatedByMouse:!1}})))},activeNext(){const{activeItem:i,activeList:a}=e(p),{index:o}=i;if(null===o)return;const{length:n}=a;0!==n&&t(p,(e=>Object.assign(Object.assign({},e),{activeItem:{index:Math.min(o+1,n-1),isActivatedByMouse:!1}})))},setDefaultList(e){t(p,(t=>Object.assign(Object.assign({},t),{defaultResult:Object.assign(Object.assign({},t.defaultResult),{list:e}),activeList:e})))},setSearchResult(e){t(p,(t=>Object.assign(Object.assign({},t),{searchResult:e,activeList:0===e.list.length?t.defaultResult.list:e.list})))},setRecentCount(e){t(p,(t=>Object.assign(Object.assign({},t),{recentCount:e})))},fetchDefaultResult(i){return g(this,void 0,void 0,(function*(){const{secUid:a}=i,o=e(p);if(o.defaultResult.list.length>0)(0,h.unstable_batchedUpdates)((()=>{this.setActiveItem({index:-1}),this.setKeyword(""),this.setActiveList(o.defaultResult.list)}));else{(0,h.unstable_batchedUpdates)((()=>{this.setLoading(!0),this.setFetchError(!1),this.setActiveItem({index:null})}));try{const[e,t]=yield Promise.all([(0,m.i_)(a),(0,m.fM)()]),{statusCode:i,userList:o=[]}=e,{status_code:n,user_list:s=[],block_results:r=[]}=t,l=(e,t)=>{var i,a;return e.uid===t.id&&(t.blockType=null===(a=null===(i=e.user_blocked_results)||void 0===i?void 0:i[0])||void 0===a?void 0:a.block_type,!0)};(0,h.unstable_batchedUpdates)((()=>{if(0===i||0===n){const e=s.map((e=>(0,c.bg)(e))).map((e=>(r.some((t=>l(t,e))),e)));this.setRecentCount(o.length),this.setDefaultList(function(e,t){let i=t;return e.forEach((e=>{i=i.filter((t=>e.uniqueId!==t.uniqueId))})),[...e,...i]}(o,e))}else this.setFetchError(!0);this.setLoading(!1),this.setActiveItem({index:-1}),this.setKeyword("")}))}catch(e){}finally{t(p,(e=>Object.assign(Object.assign({},e),{loading:!1,keyword:"",activeItem:{index:-1,isActivatedByMouse:!1}})))}}}))},fetchSearchResult(i){return g(this,void 0,void 0,(function*(){const a=e(p),{keyword:o,searchResult:{uidFilterList:n,list:s,hasMore:r}}=a,l=i===o,c=l?n:"";if(""!==i&&(!l||r)){t(p,(e=>Object.assign(Object.assign({},e),{loading:!l,isFetchError:!1,activeItem:{index:l?a.activeItem.index:null,isActivatedByMouse:!1}})));try{const e=yield(0,m.dj)(i,c),{statusCode:t,userList:o=[],hasMore:n}=e;(0,h.unstable_batchedUpdates)((()=>{if(0===t||403===t||203===t){const e=l?[...s,...o]:o,t=encodeURIComponent(JSON.stringify(e.map((e=>e.id))));this.setSearchResult({list:e,hasMore:1===n,uidFilterList:t})}else this.setFetchError(!0);this.setLoading(!1),this.setKeyword(i),this.setActiveItem({index:l?a.activeItem.index:-1})}))}catch(e){(0,h.unstable_batchedUpdates)((()=>{this.setLoading(!1),this.setFetchError(!0)}))}}}))}})));var f=i(49057),x=i(25616),_=i(32125),y=i(23237),k=i(58542),w=i(60484),C=i(84908),I=i(62186),S=i(26290);const P="linear-gradient(183.16deg, #FD1A69 8.16%, #EE3392 104.17%)",D=(0,I.default)(k.pfZ,{target:"e111lsaa0"})((({$size:e="2rem",$isLive:t})=>[{height:`${e} !important`,width:`${e} !important`},t&&{background:`linear-gradient(transparent, transparent) padding-box, ${P} border-box`,border:"2px solid transparent"}]),"label:StyledUserAvatar;"),O=(0,I.default)("div",{target:"e111lsaa1"})((()=>[{position:"relative",height:"fit-content",width:"fit-content"}]),"label:DivUserAvatarContainer;"),A=(0,I.default)("span",{target:"e111lsaa2"})((({$isTopPlacement:e})=>[{width:"2rem",height:"1.25rem",position:"absolute",left:"50%",transform:"translateX(-50%)",zIndex:1,borderRadius:"0.5rem",background:P,alignContent:"center"},e?{top:"-11px"}:{bottom:"-8px"}]),"label:SpanLiveBadge;"),T=(0,I.default)(S.F.P4,{target:"e111lsaa3"})((()=>[{textAlign:"center"}]),"label:StyledLiveText;"),E=(0,o.memo)((({badgePosition:e})=>{const t=(0,x.s)();return(0,a.jsx)(A,{$isTopPlacement:"top"===e,children:(0,a.jsx)(T,{weight:"bold",color:"UIText1Display","data-tux-color-scheme":"dark",children:t("LIVE")})})}));const L=(0,o.memo)((e=>{var{uniqueId:t,size:i,srcQuality:o="avatarThumb",isLive:n=!1,liveBadgePosition:s="bottom",e2eTag:r}=e,l=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(i[a[o]]=e[a[o]])}return i}(e,["uniqueId","size","srcQuality","isLive","liveBadgePosition","e2eTag"]);const c=(0,w.L$)((0,C.nW)((e=>e.users[t]),_.bN));return(0,a.jsxs)(O,{"data-e2e":r,children:[(0,a.jsx)(D,Object.assign({src:c[o],alt:`Avatar for ${t}`,$size:i,$isLive:n},l)),n&&(0,a.jsx)(E,{badgePosition:s})]})}));var R=i(89721);const z=(0,o.memo)((({uniqueId:e,size:t="P1",shouldUseNickname:i,shouldShowVerifiedCheck:o=!0,trailing:n,tuxTextProps:s,style:r})=>{const{nickname:l,verified:c}=(0,w.L$)((0,C.nW)((t=>t.users[e]),_.bN)),d=S.F[t],u=R.F[t].fontSize;return(0,a.jsxs)(k.rxD,{gap:"0.25rem",alignItems:"center",children:[(0,a.jsx)(d,Object.assign(Object.assign({weight:"medium"},s),{style:r,children:i&&l||e})),o&&c&&(0,a.jsx)(k.VA8,{size:u.toString()}),n]})})),U=(0,I.default)("div",{target:"em9i2uj0"})({width:"18rem",height:"16rem",overflowX:"hidden",overflowY:"scroll",scrollbarWidth:"none",backgroundColor:k.Tj4.UISheetFlat1,borderRadius:"0.75rem"},"label:DivMentionSuggestionContainer;"),F=(0,I.default)("div",{target:"em9i2uj1"})({height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"1rem"},"label:DivNoDataContainer;"),B=(0,I.default)("div",{target:"em9i2uj2"})((({isActive:e,isDisabled:t})=>({height:"3rem",width:"100%",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.25rem 0.5rem",cursor:t?"default":"pointer",borderBottom:`1px solid ${k.Tj4.UISheetFlat3}`,backgroundColor:e?k.Tj4.UISheetFlat2:"transparent",opacity:t?.34:1})),"label:DivMentionSuggestionItem;"),N=(0,I.default)("div",{target:"em9i2uj3"})({display:"flex",flexDirection:"column",overflow:"hidden"},"label:DivMentionUserInfo;"),M=(0,o.memo)((function({isActive:e,index:t,mentionUser:i,intersectionObserver:n}){var s;const{user:r}=null!==(s=(0,f.W)((()=>["user"]),[]))&&void 0!==s?s:{},{setActiveItem:l}=b(),c=(0,x.s)(),d=(0,o.useRef)(null),{uniqueId:u,relation:m,blockType:h}=i,g=(0,o.useMemo)((()=>1===m||2===m),[m]),p=1===h||u===(null==r?void 0:r.uniqueId);(0,o.useEffect)((()=>{d.current&&n&&n.observe(d.current)}),[t,n]),(0,o.useEffect)((()=>{var t;e&&(null===(t=d.current)||void 0===t||t.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"}))}),[e]);const j=(0,o.useCallback)((()=>{l({index:t,isActivatedByMouse:!0})}),[l,t]),v=(0,o.useCallback)((()=>{j()}),[j]);return(0,a.jsxs)(B,{ref:d,"data-index":t,"data-e2e":"comment-at-list",isActive:e,isDisabled:p,onMouseEnter:j,onFocus:v,children:[(0,a.jsx)(L,{uniqueId:u,size:40,style:{flexBasis:"40px"}}),(0,a.jsxs)(N,{children:[(0,a.jsxs)(k.rxD,{gap:"0.25rem",alignItems:"center",children:[(0,a.jsx)(z,{"data-e2e":"comment-at-nickname",uniqueId:u,size:"P3",shouldUseNickname:!0,tuxTextProps:{weight:"normal"},style:{textWrap:"nowrap"}}),g?(0,a.jsxs)(a.Fragment,{children:["Â·",(0,a.jsx)(S.F.P4,{color:"UIText3",weight:"medium",children:c("Following")})]}):null]}),(0,a.jsx)(z,{"data-e2e":"comment-at-uniqueid",uniqueId:u,size:"P4",shouldShowVerifiedCheck:!1,tuxTextProps:{truncate:!0,weight:"normal"},style:{textWrap:"nowrap"}})]})]})})),W=({keyword:e,containerRef:t})=>{var i;const{user:n}=null!==(i=(0,f.W)((()=>["user"]),[]))&&void 0!==i?i:{},[{activeList:s,activeIndex:r,recentCount:c},{fetchSearchResult:d}]=j((e=>({activeList:e.activeList,activeIndex:e.activeItem.index,recentCount:e.recentCount})),_.bN),u=(0,o.useRef)(),m=(0,o.useRef)({}),h=(0,o.useCallback)((()=>{e&&d(e)}),[d,e]),g=(0,o.useCallback)((t=>{const i=s[t],{blockType:a,uniqueId:o,id:r,relation:d}=i,u=1===a||o===(null==n?void 0:n.uniqueId);let m="all_user";!e&&t<c?m="recent":1===d?m="following":2===d&&(m="friends"),l.ao.handleMentionItemShow({to_user_id:r,user_type:m,search_keyword:e,is_valid:u?"0":"1"})}),[s,e,c,null==n?void 0:n.uniqueId]),p=(0,o.useCallback)((e=>{var t;const i=e.target.getAttribute("data-index");if(!i)return;const a=Number(i);e.intersectionRatio>0&&!m.current[a]&&(g(a),null===(t=u.current)||void 0===t||t.unobserve(e.target)),s.length-a<3&&h()}),[s.length,h,g]);return(0,o.useEffect)((()=>(u.current=new IntersectionObserver((e=>e.forEach(p)),{root:t.current,threshold:1}),()=>{var e;return null===(e=u.current)||void 0===e?void 0:e.disconnect()})),[t,p]),(0,a.jsx)(a.Fragment,{children:s.map(((e,t)=>(0,a.jsx)(M,{mentionUser:e,index:t,isActive:r===t,intersectionObserver:u.current},e.id)))})},q=(0,o.memo)((()=>{const e=(0,x.s)();return(0,a.jsxs)(F,{children:[(0,a.jsx)(k.XWZ,{size:"small"}),(0,a.jsx)(S.F.P2,{children:e("comment_at_search")})]})})),$=(0,o.memo)((({keyword:e,secUid:t})=>{const{fetchDefaultResult:i,fetchSearchResult:n}=b(),s=(0,x.s)(),r=(0,o.useCallback)((a=>{a.stopPropagation(),a.preventDefault(),""===e?i({secUid:t}):n(e)}),[t,i,n,e]);return(0,a.jsxs)(F,{children:[(0,a.jsx)(S.F.P1,{color:"UIText3",children:s("comment_at_load")}),(0,a.jsx)(k.I05,{label:s("comment_at_tryagain"),shape:"borderless",onClick:r})]})})),G=({keyword:e,open:t,setOpen:i,trigger:n,handleSelectUser:s})=>{var r;const{user:l}=null!==(r=(0,f.W)((()=>["user"]),[]))&&void 0!==r?r:{},{secUid:c=""}=(0,w.L$)(l),[{loading:d,isFetchError:u},{fetchDefaultResult:m,fetchSearchResult:h,activePrev:g,activeNext:p}]=j((e=>({loading:e.loading,isFetchError:e.isFetchError})),_.bN),b=(0,o.useRef)(null);(0,o.useEffect)((()=>{m({secUid:c})}),[m,c]),(0,o.useEffect)((()=>{null!==e&&(""===e?m({secUid:c}):h(e))}),[e,c,m,h]);const v=(0,o.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),s()}),[s]),x=(0,o.useCallback)((e=>{e.stopPropagation(),"Escape"!==e.key?d||u||("ArrowUp"===e.key?(e.preventDefault(),g()):"ArrowDown"===e.key&&(e.preventDefault(),p()),"Enter"===e.key&&s()):i(!1)}),[p,g,s,u,d,i]),y=(0,o.useMemo)((()=>d?(0,a.jsx)(q,{}):u?(0,a.jsx)($,{keyword:null!=e?e:"",secUid:c}):(0,a.jsx)(W,{keyword:null!=e?e:"",containerRef:b})),[d,u,e,c]);return(0,a.jsx)(k.Xwo,{open:t,trigger:n,"data-e2e":"comment-at-user",placement:"top",noArrow:!0,style:{zIndex:3002},children:(0,a.jsx)(U,{ref:b,tabIndex:0,onClick:v,onKeyDown:x,children:y})})},H=(0,I.default)(k.I05,{target:"exxlnep0"})((({isActive:e})=>[{"&.TUXButton":{margin:"0.25rem 0",minWidth:"unset",width:"2rem",height:"2rem",padding:"0.25rem",borderRadius:"0.5rem",cursor:"pointer",backgroundColor:e?k.Tj4.UIShapeNeutral3:"transparent",":hover":{backgroundColor:k.Tj4.UIShapeNeutral3},svg:{width:"100%",height:"100%",minWidth:"1.5rem",minHeight:"1.5rem"}}}]),"label:StyledMentionSuggestionButton;");H.defaultProps=Object.assign(Object.assign({},H.defaultProps),{"data-e2e":"comment-at-icon"});const V=(0,o.forwardRef)((({isActive:e,setIsActive:t,teaParams:i},n)=>{const s=(0,x.s)(),r=(0,o.useCallback)((a=>{a.stopPropagation(),a.preventDefault(),e?t(!1):(t(!0),l.ao.handleSearchAt(Object.assign(Object.assign({},i),{enter_method:"button"})))}),[e,t,i]),c=(0,o.useCallback)((a=>{a.stopPropagation(),e||"Enter"!==a.key&&" "!==a.key||(t(!0),l.ao.handleSearchAt(Object.assign(Object.assign({},i),{enter_method:"button"}))),"Escape"===a.key&&t(!1)}),[e,t,i]);return(0,a.jsx)(k.N0Y,{variant:"secondary",placement:"top",size:"small",content:s("comment_tray_at"),visible:!e&&void 0,children:(0,a.jsx)(H,{ref:n,label:"",variant:"secondary",leadingIcon:(0,a.jsx)(k.C1D,{}),"aria-label":s("comment_tray_at"),"aria-expanded":e,isActive:e,onClick:r,onKeyDown:c,tabIndex:0})})})),K=({keyword:e,setIsActive:t,onSelectUser:i,teaParams:n})=>{var s;const r=(0,o.useMemo)((()=>null!==e),[e]),{user:c}=null!==(s=(0,f.W)((()=>["user"]),[]))&&void 0!==s?s:{},{activeUser:d}=v((e=>{var t;return{activeUser:e.activeList[null!==(t=e.activeItem.index)&&void 0!==t?t:-1]}}),_.bN),u=(0,x.s)(),{showToast:m}=(0,y.n)("top"),h=(0,o.useCallback)((()=>{d&&(1!==d.blockType?d.uniqueId!==(null==c?void 0:c.uniqueId)?(null==i||i(d),l.ao.handleSelectAt(Object.assign(Object.assign({},n),{to_user_id:d.id}))):m(u("no_at_me")):m(u("mention_privacy_toast_cant_mention")))}),[d,i,m,u,n,null==c?void 0:c.uniqueId]);return(0,a.jsx)(G,{keyword:e,open:r,setOpen:t,handleSelectUser:h,trigger:(0,a.jsx)(V,{isActive:r,setIsActive:t,teaParams:n})})},X=(0,I.default)(k.I05,{target:"e1bzzyq0"})((({isActive:e})=>[{"&.TUXButton":{margin:"0.25rem 0",minWidth:"unset",width:"2rem",height:"2rem",padding:"0.25rem",borderRadius:"0.5rem",cursor:"pointer",backgroundColor:e?k.Tj4.UIShapeNeutral3:"transparent",":hover":{backgroundColor:k.Tj4.UIShapeNeutral3},svg:{width:"100%",height:"100%",minWidth:"1.5rem",minHeight:"1.5rem"}}}]),"label:StyledEmojiButton;");X.defaultProps=Object.assign(Object.assign({},X.defaultProps),{"data-e2e":"comment-emoji-icon"});const Y=(0,o.forwardRef)((({isActive:e,setIsActive:t,onClickOpenEmojiPanel:i},n)=>{const s=(0,x.s)(),r=(0,o.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),t((t=>(t||null==i||i(e),!t)))}),[t,i]),l=(0,o.useCallback)((e=>{e.stopPropagation(),"Enter"===e.key||" "===e.key?t((e=>!e)):"Escape"===e.key&&t(!1)}),[t]);return(0,a.jsx)(k.N0Y,{variant:"secondary",placement:"top",size:"small",content:s("comment_tray_emoji"),visible:!e&&void 0,children:(0,a.jsx)(X,{ref:n,label:"",variant:"secondary",leadingIcon:(0,a.jsx)(k.dpn,{}),"aria-label":s("comment_tray_emoji"),"aria-expanded":e,isActive:e,onClick:r,onKeyDown:l,tabIndex:0})})})),Q=[{name:"basic",data:[{emoji:"ğŸ˜€",alias:"grinning"},{emoji:"ğŸ˜ƒ",alias:"smiley"},{emoji:"ğŸ˜„",alias:"smile"},{emoji:"ğŸ˜",alias:"grin"},{emoji:"ğŸ˜†",alias:"laughing"},{emoji:"ğŸ˜…",alias:"sweat_smile"},{emoji:"ğŸ¤£",alias:"rofl"},{emoji:"ğŸ˜‚",alias:"joy"},{emoji:"ğŸ™‚",alias:"slightly_smiling_face"},{emoji:"ğŸ™ƒ",alias:"upside_down_face"},{emoji:"ğŸ˜‰",alias:"wink"},{emoji:"ğŸ˜Š",alias:"blush"},{emoji:"ğŸ˜‡",alias:"innocent"},{emoji:"ğŸ˜",alias:"heart_eyes"},{emoji:"ğŸ˜˜",alias:"kissing_heart"},{emoji:"ğŸ˜—",alias:"kissing"},{emoji:"ğŸ˜š",alias:"kissing_closed_eyes"},{emoji:"ğŸ˜™",alias:"kissing_smiling_eyes"},{emoji:"ğŸ˜‹",alias:"yum"},{emoji:"ğŸ˜›",alias:"stuck_out_tongue"},{emoji:"ğŸ˜œ",alias:"stuck_out_tongue_winking_eye"},{emoji:"ğŸ˜",alias:"stuck_out_tongue_closed_eyes"},{emoji:"ğŸ¤‘",alias:"money_mouth_face"},{emoji:"ğŸ¤—",alias:"hugs"},{emoji:"ğŸ¤”",alias:"thinking"},{emoji:"ğŸ¤",alias:"zipper_mouth_face"},{emoji:"ğŸ˜",alias:"neutral_face"},{emoji:"ğŸ˜‘",alias:"expressionless"},{emoji:"ğŸ˜¶",alias:"no_mouth"},{emoji:"ğŸ˜",alias:"smirk"},{emoji:"ğŸ˜’",alias:"unamused"},{emoji:"ğŸ™„",alias:"roll_eyes"},{emoji:"ğŸ˜¬",alias:"grimacing"},{emoji:"ğŸ¤¥",alias:"lying_face"},{emoji:"ğŸ˜Œ",alias:"relieved"},{emoji:"ğŸ˜”",alias:"pensive"},{emoji:"ğŸ˜ª",alias:"sleepy"},{emoji:"ğŸ¤¤",alias:"drooling_face"},{emoji:"ğŸ˜´",alias:"sleeping"},{emoji:"ğŸ˜·",alias:"mask"},{emoji:"ğŸ¤’",alias:"face_with_thermometer"},{emoji:"ğŸ¤•",alias:"face_with_head_bandage"},{emoji:"ğŸ¤¢",alias:"nauseated_face"},{emoji:"ğŸ¤§",alias:"sneezing_face"},{emoji:"ğŸ˜µ",alias:"dizzy_face"},{emoji:"ğŸ¤ ",alias:"cowboy_hat_face"},{emoji:"ğŸ˜",alias:"sunglasses"},{emoji:"ğŸ¤“",alias:"nerd_face"},{emoji:"ğŸ˜•",alias:"confused"},{emoji:"ğŸ˜Ÿ",alias:"worried"},{emoji:"ğŸ™",alias:"slightly_frowning_face"},{emoji:"ğŸ˜®",alias:"open_mouth"},{emoji:"ğŸ˜¯",alias:"hushed"},{emoji:"ğŸ˜²",alias:"astonished"},{emoji:"ğŸ˜³",alias:"flushed"},{emoji:"ğŸ˜¦",alias:"frowning"},{emoji:"ğŸ˜§",alias:"anguished"},{emoji:"ğŸ˜¨",alias:"fearful"},{emoji:"ğŸ˜°",alias:"cold_sweat"},{emoji:"ğŸ˜¥",alias:"disappointed_relieved"},{emoji:"ğŸ˜¢",alias:"cry"},{emoji:"ğŸ˜­",alias:"sob"},{emoji:"ğŸ˜±",alias:"scream"},{emoji:"ğŸ˜–",alias:"confounded"},{emoji:"ğŸ˜£",alias:"persevere"},{emoji:"ğŸ˜",alias:"disappointed"},{emoji:"ğŸ˜“",alias:"sweat"},{emoji:"ğŸ˜©",alias:"weary"},{emoji:"ğŸ˜«",alias:"tired_face"},{emoji:"ğŸ˜¤",alias:"triumph"},{emoji:"ğŸ˜¡",alias:"rage"},{emoji:"ğŸ˜ ",alias:"angry"},{emoji:"ğŸ˜ˆ",alias:"smiling_imp"},{emoji:"ğŸ‘¿",alias:"imp"},{emoji:"ğŸ’€",alias:"skull"},{emoji:"ğŸ’©",alias:"hankey"},{emoji:"ğŸ¤¡",alias:"clown_face"},{emoji:"ğŸ‘¹",alias:"japanese_ogre"},{emoji:"ğŸ‘º",alias:"japanese_goblin"},{emoji:"ğŸ‘»",alias:"ghost"},{emoji:"ğŸ‘½",alias:"alien"},{emoji:"ğŸ‘¾",alias:"space_invader"},{emoji:"ğŸ¤–",alias:"robot"},{emoji:"ğŸ˜º",alias:"smiley_cat"},{emoji:"ğŸ˜¸",alias:"smile_cat"},{emoji:"ğŸ˜¹",alias:"joy_cat"},{emoji:"ğŸ˜»",alias:"heart_eyes_cat"},{emoji:"ğŸ˜¼",alias:"smirk_cat"},{emoji:"ğŸ˜½",alias:"kissing_cat"},{emoji:"ğŸ™€",alias:"scream_cat"},{emoji:"ğŸ˜¿",alias:"crying_cat_face"},{emoji:"ğŸ˜¾",alias:"pouting_cat"}],iconIndex:11}];var Z=i(15936);const J=(0,I.default)("div",{target:"e1ja9a0q0"})((()=>({width:"21rem",height:"18rem",padding:"0.5rem",borderRadius:"0.75rem",display:"flex",flexDirection:"column",backgroundColor:k.Tj4.UISheetFlat1})),"label:DivEmojiPanelContainer;"),ee=(0,I.default)("ul",{target:"e1ja9a0q1"})((()=>({listStyleType:"none",margin:0,padding:0,paddingTop:"0.5rem",borderTop:`1px solid ${k.Tj4.UISheetFlat3}`,display:"flex",flexDirection:"row"})),"label:UlEmojiGroupList;"),te=(0,I.default)("div",{target:"e1ja9a0q2"})((()=>({overflowY:"scroll","::-webkit-scrollbar":{width:4},"::-webkit-scrollbar-track":{marginTop:8},"::-webkit-scrollbar-thumb":{borderRadius:2,backgroundColor:k.Tj4.UIShapeNeutral4},":hover::-webkit-scrollbar-thumb":{backgroundColor:k.Tj4.UIShapeNeutral3},"@supports not selector(::-webkit-scrollbar)":{scrollbarWidth:"thin",scrollbarColor:k.Tj4.UIShapeNeutral4,scrollbarGutter:k.Tj4.UISheetFlat1}})),"label:DivEmojiListContainer;"),ie=(0,I.default)("ul",{target:"e1ja9a0q3"})({width:"100%",height:"100%",margin:0,padding:0,display:"flex",flexWrap:"wrap",gap:"6px"},"label:UlEmojiList;"),ae=(0,I.default)("li",{target:"e1ja9a0q4"})((({isActive:e})=>[{listStyleType:"none",width:"2.5rem",height:"2.5rem",fontSize:"1.5rem",lineHeight:"2.5rem",cursor:"pointer",textAlign:"center",backgroundColor:e?k.Tj4.UISheetFlat2:"transparent",borderRadius:"0.5rem",":hover":{backgroundColor:k.Tj4.UISheetFlat2}}]),"label:LiEmojiItem;"),oe=(0,o.memo)((({emojis:e,onSelect:t})=>{const i=(0,o.useRef)(-1),n=(0,o.useCallback)((e=>{const t=e.target;if("li"===t.nodeName.toLocaleLowerCase()){const e=t.getAttribute("data-index");i.current=e?Number(e):-1}}),[]),s=(0,o.useCallback)((()=>{var e;if("li"===(null===(e=document.activeElement)||void 0===e?void 0:e.nodeName.toLocaleLowerCase())){const e=document.activeElement.getAttribute("data-index");i.current=e?Number(e):-1}}),[]),r=(0,o.useCallback)((a=>{a.stopPropagation(),a.preventDefault();const o=i.current;-1!==o&&t(e[o].emoji)}),[e,t]),l=(0,Z.B)(r,["Enter"," "]);return(0,a.jsx)(ie,{onMouseOver:n,onClick:r,onKeyDown:l,children:e.map(((e,t)=>(0,a.jsx)(ae,{"data-index":t,isActive:!1,tabIndex:0,onFocus:s,children:e.emoji},e.alias)))})})),ne=({emojiGroupIndex:e,setEmojiGroupIndex:t})=>{const i=(0,o.useCallback)((e=>{e.stopPropagation(),e.preventDefault();const i=e.target;if("li"===i.nodeName.toLocaleLowerCase()){const e=i.getAttribute("data-index");t(e?Number(e):0)}}),[t]);return(0,a.jsx)(ee,{onClick:i,role:"tablist",children:Q.map((({name:t,data:i,iconIndex:o},n)=>(0,a.jsx)(ae,{"data-index":n,isActive:n===e,role:"tab",tabIndex:0,"aria-selected":n===e,"aria-controls":"emoji-panel-container",children:i[o].emoji},t)))})},se=(0,o.memo)((({open:e,trigger:t,setIsOpen:i,onSelectEmoji:n})=>{const[s,r]=(0,o.useState)(0),l=(0,o.useMemo)((()=>Q[s]),[s]),c=(0,o.useCallback)((t=>{t.stopPropagation(),e&&"Escape"===t.key&&i(!1)}),[e,i]);return(0,a.jsx)(k.Xwo,{open:e,trigger:t,onOpenChange:i,"data-e2e":"comment-emoji-list",placement:"top",autoFocus:!0,noArrow:!0,style:{zIndex:3002},children:(0,a.jsxs)(J,{onKeyDown:c,children:[(0,a.jsx)(te,{"data-e2e":"comment-emoji-group",children:(0,a.jsx)(oe,{emojis:l.data,onSelect:n},l.name)}),(0,a.jsx)(ne,{emojiGroupIndex:s,setEmojiGroupIndex:r})]})})})),re=({onClickOpenEmojiPanel:e,onSelectEmoji:t,teaParams:i})=>{const[n,s]=(0,o.useState)(!1),r=(0,o.useCallback)((e=>{var a;null==t||t(e),s(!1),l.ao.handleEmojiSelect(Object.assign(Object.assign({},i),{enter_method:"button",emoji_code:(a=e,[...a].map((e=>`${e.codePointAt(0)}`)))[0]}))}),[t,s,i]);return(0,a.jsx)(se,{open:n,setIsOpen:s,onSelectEmoji:r,trigger:(0,a.jsx)(Y,{isActive:n,setIsActive:s,onClickOpenEmojiPanel:e})})};var le=i(62413),ce=i(11983),de=i(95197),ue=i(87652),me=i(58305),he=i(78662),ge=i(88920),pe=i(53764),je=i(64231);const be=(0,i(47236).Ay)({resolved:{},chunkName:()=>"editor",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!i.m[t]},importAsync:()=>Promise.all([i.e(2939),i.e(9187),i.e(8395),i.e(6008)]).then(i.bind(i,81833)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return i(t)},resolve:()=>81833});var ve=i(65329),fe=i(72153);const xe=(0,I.default)("div",{target:"exl80ic0"})((({theme:{colors:e}})=>({width:"100%",height:"100%",display:"flex",flexDirection:"column-reverse",backgroundColor:e.BGPrimary})),"label:DivEmojiSuggestionContainer;"),_e=(0,I.default)("ul",{target:"exl80ic1"})((({theme:{colors:e}})=>({listStyleType:"none",margin:0,padding:0,order:1,flex:"0 0 38px",borderTop:`1px solid ${e.LineSecondary}`,display:"flex",flexDirection:"row"})),"label:UlNavContainer;"),ye=(0,I.default)("div",{target:"exl80ic2"})((({theme:{colors:e}})=>({order:2,flex:"1 1 100%",overflowY:"scroll",scrollbarWidth:"none","::-webkit-scrollbar":{width:4},"::-webkit-scrollbar-track":{marginTop:8},"::-webkit-scrollbar-thumb":{borderRadius:2,backgroundColor:e.LineSecondary},":hover::-webkit-scrollbar-thumb":{backgroundColor:e.TextQuaternary}})),"label:DivPanelContainer;"),ke=(0,I.default)("ul",{target:"exl80ic3"})({listStyleType:"none",margin:0,padding:0,width:"100%",height:"100%",display:"flex",flexWrap:"wrap"},"label:UlPanelList;"),we=(0,I.default)("li",{target:"exl80ic4"})((({theme:e,theme:{colors:t},isActive:i})=>[(0,fe.zy)({theme:e,color:"ConstBGInverse",typography:"H4"}),{listStyleType:"none",flex:"0 0 auto",width:40,height:40,lineHeight:"46px",margin:"5px 6px",cursor:"pointer",textAlign:"center",backgroundColor:i?t.BGInput:t.BGPrimary,borderRadius:8,":hover":{backgroundColor:t.BGInput}}]),"label:LiItem;"),Ce=(0,o.memo)((function({emojis:e,onSelect:t}){const i=(0,o.useRef)(-1),n=(0,o.useCallback)((e=>{const t=e.target;if("li"===t.nodeName.toLocaleLowerCase()){const e=t.getAttribute("data-index");i.current=e?Number(e):-1}}),[]),s=(0,o.useCallback)((()=>{var e,t;if("li"===(null===(e=document.activeElement)||void 0===e?void 0:e.nodeName.toLocaleLowerCase())){const e=null===(t=document.activeElement)||void 0===t?void 0:t.getAttribute("data-index");i.current=e?Number(e):-1}}),[]),r=(0,o.useCallback)((a=>{(0,me.Gu)(a);const o=i.current;-1!==o&&t(e[o].emoji)}),[e,t]),l=(0,o.useCallback)((a=>{if(13===a.keyCode||32===a.keyCode){a.stopPropagation(),a.preventDefault();const o=i.current;-1!==o&&t(e[o].emoji)}}),[e,t]);return(0,a.jsx)(ke,{onMouseOver:n,onClick:r,onKeyDown:l,children:e.map(((e,t)=>(0,a.jsx)(we,{"data-index":t,isActive:!1,tabIndex:0,onFocus:s,children:e.emoji},e.alias)))})})),Ie=[{name:"basic",data:ve.A,iconIndex:11}],Se=(0,o.memo)((function(e){const[t,i]=(0,o.useState)(0),n=(0,o.useCallback)((e=>{(0,me.Gu)(e);const t=e.target;if("li"===t.nodeName.toLocaleLowerCase()){const e=t.getAttribute("data-index");i(e?Number(e):0)}}),[]);return(0,a.jsxs)(xe,{children:[(0,a.jsx)(_e,{onClick:n,role:"tablist",children:Ie.map((({name:e,data:i,iconIndex:o},n)=>(0,a.jsx)(we,{"data-index":n,isActive:n===t,role:"tab",tabIndex:0,"aria-selected":n===t,"aria-controls":"emoji-panel-container",children:i[o].emoji},e)))}),(0,a.jsx)(ye,{"data-e2e":"comment-emoji-group",children:(0,a.jsx)(Ce,{emojis:Ie[t].data,onSelect:e.onSelect},Ie[t].name)})]})}));var Pe=i(67518),De=i(90159),Oe=i(10745),Ae=i(50289),Te=i(92846);const Ee=(0,I.default)("div",{target:"e16bf9xh0"})((({theme:{colors:e}})=>({width:"100%",height:"100%",overflowX:"hidden",overflowY:"scroll",backgroundColor:e.BGPrimary,scrollbarWidth:"none","::-webkit-scrollbar":{width:0}})),"label:DivContainer;"),Le=(0,I.default)("div",{target:"e16bf9xh1"})({display:"flex",flexDirection:"column",alignItems:"center"},"label:DivNotItemContainer;"),Re=(0,I.default)("p",{target:"e16bf9xh2"})((({theme:e})=>(0,fe.zy)({theme:e,color:"TextTertiary",typography:"H6"})),{flex:"1 1 auto",margin:"18px auto"},"label:PLoadingText;"),ze=(0,I.default)("p",{target:"e16bf9xh3"})((({theme:e})=>(0,fe.zy)({theme:e,color:"TextTertiary",typography:"H5"})),{flex:"1 1 auto",marginTop:106},"label:PErrorText;"),Ue=(0,I.default)("p",{target:"e16bf9xh4"})((({theme:e})=>(0,fe.zy)({theme:e,color:"Primary",typography:"H6"})),{flex:"1 1 auto",margin:"11px auto",cursor:"pointer"},"label:PRetryText;"),Fe=(0,I.default)("div",{target:"e16bf9xh5"})((({theme:{colors:e},isDisabled:t})=>({height:"100%",padding:"4px 0",margin:"0 16px",display:"flex",cursor:t?"default":"pointer",borderBottom:`1px solid ${e.LineSecondary}`})),"label:DivItemContainer;"),Be=(0,I.default)("div",{target:"e16bf9xh6"})((({theme:{colors:e},isActive:t,isDisabled:i})=>({height:48,backgroundColor:t?e.BGView:e.BGPrimary,opacity:i?.34:1})),"label:DivItemBackground;"),Ne=(0,I.default)("div",{target:"e16bf9xh7"})([{flex:"1 1 auto",overflow:"hidden"},({theme:{direction:e}})=>(0,fe.mp)({direction:e,marginStart:8})],"label:DivInfoContainer;"),Me=(0,I.default)("p",{target:"e16bf9xh8"})([{display:"flex",alignItems:"center"}],"label:PMentionInfoLine;"),We=(0,I.default)("span",{target:"e16bf9xh9"})((({theme:e})=>(0,fe.zy)({theme:e,fontWeight:"semiBold",typography:"P3"})),fe.PR,"label:SpanInfoNickname;"),qe=(0,I.default)("span",{target:"e16bf9xh10"})((({theme:e})=>(0,fe.zy)({theme:e,fontWeight:"normal",typography:"P4"})),fe.PR,"label:SpanInfoUniqueId;"),$e=(0,I.default)("span",{target:"e16bf9xh11"})({margin:"0px 4px"},"label:SpanInfoDot;"),Ge=(0,I.default)("span",{target:"e16bf9xh12"})({fontSize:"10px"},"label:SpanInfoVerify;"),He=(0,I.default)("span",{target:"e16bf9xh13"})((({theme:e})=>(0,fe.zy)({theme:e,color:"TextTertiary",fontWeight:"semiBold",typography:"P4"})),{verticalAlign:"middle",flexShrink:0},"label:SpanInfoFollowing;"),Ve=(0,o.memo)((function({isActive:e,index:t,user:i}){var n;const s=(0,x.s)(),{user:r}=null!==(n=(0,f.W)((()=>["user"]),[]))&&void 0!==n?n:{},{nickname:l,uniqueId:c,verified:d,relation:u,avatarThumb:m,blockType:h}=i,g=(0,o.useMemo)((()=>1===u||2===u),[u]),p=1===h||c===(null==r?void 0:r.uniqueId),{setActiveItem:j}=b(),v=(0,o.useCallback)((()=>{j({index:t,isActivatedByMouse:!0})}),[j,t]),_=(0,o.useCallback)((()=>{v()}),[v]);return(0,a.jsx)(Be,{"data-e2e":"comment-at-list",isActive:e,isDisabled:p,onMouseEnter:v,tabIndex:0,onFocus:_,children:(0,a.jsxs)(Fe,{isDisabled:p,children:[(0,a.jsx)(Te.e,{size:40,src:m,style:{flex:"0 0 40px"}}),(0,a.jsxs)(Ne,{children:[(0,a.jsxs)(Me,{children:[(0,a.jsx)(We,{"data-e2e":"comment-at-nickname",children:l}),d&&(0,a.jsx)(Ge,{children:(0,a.jsx)(Ae.s,{})}),g&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($e,{children:"Â·"}),(0,a.jsx)(He,{children:s("Following")})]})]}),(0,a.jsx)(Me,{children:(0,a.jsx)(qe,{"data-e2e":"comment-at-uniqueid",children:c})})]})]})})}));var Ke=i(45446);const Xe=(0,o.memo)((function({keyword:e="",onSelect:t}){var i;const n=(0,x.s)(),{colors:s}=(0,Pe.u)(),{user:r}=null!==(i=(0,f.W)((()=>["user"]),[]))&&void 0!==i?i:{},{secUid:c=""}=(0,w.L$)(r),[{loading:d,isFetchError:u,activeList:m,activeItem:h,recentCount:g},{fetchDefaultResult:p,fetchSearchResult:b}]=j((e=>({loading:e.loading,isFetchError:e.isFetchError,activeList:e.activeList,activeItem:e.activeItem,recentCount:e.recentCount})),_.bN),{index:v}=h,y=(0,o.useRef)(null),k=(0,o.useRef)([]);(0,o.useEffect)((()=>{p({secUid:c})}),[p,c]),(0,o.useEffect)((()=>{""===e?p({secUid:c}):b(e)}),[e,c,p,b]),(0,o.useEffect)((()=>{const{index:e,isActivatedByMouse:t}=h;t||function(e,t){if(null===t||-1===t||null===e.current)return;const i=48*t,a=48*(t+1),o=e.current.clientHeight,{scrollTop:n}=e.current;i<n?e.current.scrollTop=i:a>o+n&&(e.current.scrollTop=a-o)}(y,e)}),[h]);const C=(0,o.useCallback)((()=>""!==e&&b(e)),[b,e]);(0,Oe.O9)({elemRef:y,onHitBottom:C,bottomThreshold:96});const I=(0,o.useCallback)((t=>{(0,me.Gu)(t),""===e?p({secUid:c}):b(e)}),[c,p,b,e]),S=(0,o.useCallback)((e=>{(0,me.Gu)(e),null==t||t()}),[t]),P=(0,o.useCallback)((t=>{m.slice(t,t+5).forEach(((i,a)=>{if(k.current[t+a])return;const{blockType:o,uniqueId:n,id:s,relation:c}=i,d=1===o||n===(null==r?void 0:r.uniqueId);let u="all_user";!e&&t+a<g?u="recent":1===c?u="following":2===c&&(u="friends"),l.ao.handleMentionItemShow({to_user_id:s,user_type:u,search_keyword:e,is_valid:d?"0":"1"}),k.current[t+a]=!0}))}),[m,null==r?void 0:r.uniqueId,e,g]),D=(0,De._g)((e=>{const{scrollTop:t}=e.target,i=Math.floor(t/48);P(i)}),[P],50);return(0,o.useEffect)((()=>{P(0)}),[P]),d?(0,a.jsx)(Ee,{children:(0,a.jsxs)(Le,{children:[(0,a.jsx)(Ke.h,{size:26,fill:s.TextTertiary,style:{marginTop:80,flex:"1 1 auto"}}),(0,a.jsx)(Re,{children:n("comment_at_search")})]})}):u?(0,a.jsx)(Ee,{children:(0,a.jsxs)(Le,{children:[(0,a.jsx)(ze,{children:n("comment_at_load")}),(0,a.jsx)(Ue,{onClick:I,children:n("comment_at_tryagain")})]})}):(0,a.jsx)(Ee,{ref:y,onClick:S,onScroll:D,children:m.map(((e,t)=>(0,a.jsx)(Ve,{user:e,index:t,isActive:v===t},t)))})}));var Ye=i(34251),Qe=i(30543),Ze=i(93811);const Je=(0,o.memo)((function({itemId:e,disable:t,teaParams:i,childInputRef:c,isReply:d,isCommentRedesign:u,onBlur:m=()=>{},onFocus:h=()=>{},onClose:g=()=>{},useNewPopover:p}){var b;const{user:v}=null!==(b=(0,f.W)((()=>["user"]),[]))&&void 0!==b?b:{},[{activeItem:y,activeList:k},{activePrev:w,activeNext:C}]=j((({activeItem:e,activeList:t})=>({activeItem:e,activeList:t})),_.bN),{shouldOptimizeReply:I}=(0,ge.kb)(),[S,P]=(0,o.useState)(!1),{index:D}=y,O=(0,Ze.Em)(d),A=(0,Ze.WA)(),{publishComment:T,setNeedResetKeyword:E,setIsInputFocus:L}=(0,ue.$4)(),[R,z]=(0,o.useState)(null),[U,F]=(0,o.useState)(!1),B=(0,o.useRef)(null),N=(0,o.useRef)(null),M=null!=c?c:N,W=(0,x.s)(),[q,$]=(0,o.useState)(!1);(0,o.useEffect)((()=>{$(!0)}),[]);const G=(0,o.useCallback)((e=>{var t;(0,me.Gu)(e),null===(t=M.current)||void 0===t||t.handleInsertMentionTrigger(),l.ao.handleSearchAt(Object.assign(Object.assign({},i),{enter_method:"button"}))}),[i]),H=(0,o.useCallback)((e=>{var t;13!==e.keyCode&&32!==e.keyCode||(e.stopPropagation(),e.preventDefault(),null===(t=M.current)||void 0===t||t.handleInsertMentionTrigger(),l.ao.handleSearchAt(Object.assign(Object.assign({},i),{enter_method:"button"})))}),[i]),V=(0,o.useCallback)((e=>{"@"===e&&l.ao.handleSearchAt(Object.assign(Object.assign({},i),{enter_method:"input"}))}),[i]),X=(0,o.useCallback)((()=>{var e;if(null===R||null===D)return;const t=k[D];t&&(1!==t.blockType?t.uniqueId!==(null==v?void 0:v.uniqueId)?(null===(e=M.current)||void 0===e||e.handleSelectUser(t),l.ao.handleSelectAt(Object.assign(Object.assign({},i),{to_user_id:t.id}))):ce.F.open({content:W("no_at_me"),duration:3,widthType:"half",getContainer:pe.M,getContainerPosition:"fixed"}):ce.F.open({content:W("mention_privacy_toast_cant_mention"),duration:3,widthType:"half",getContainer:pe.M,getContainerPosition:"fixed"}))}),[D,k,R,W,i,v]),Y=(0,o.useCallback)((e=>{var t,a,o;null===(t=M.current)||void 0===t||t.handleSelectEmoji(e),F(!1),l.ao.handleEmojiSelect(Object.assign(Object.assign({},i),{enter_method:"button",emoji_code:null===(o=e,a=[...o].map((e=>`${e.codePointAt(0)}`)))||void 0===a?void 0:a[0]}))}),[i]),Q=(0,o.useCallback)((e=>{var t;(0,me.Gu)(e),F(!U),z(null),p||null===(t=M.current)||void 0===t||t.focus()}),[U,p]),Z=(0,o.useCallback)((e=>{13===e.keyCode||32===e.keyCode?(e.stopPropagation(),e.preventDefault(),F(!U),z(null)):U&&27===e.keyCode&&(e.stopPropagation(),e.preventDefault(),F(!1),z(null))}),[U]),J=(0,o.useCallback)((e=>{U&&27===e.keyCode&&(e.stopPropagation(),e.preventDefault(),F(!1),z(null))}),[U]),ee=(0,o.useCallback)((t=>()=>{var a,o;if(!O){const n=null!==(o=null===(a=M.current)||void 0===a?void 0:a.getTextInfo())&&void 0!==o?o:{inputText:"",textExtra:[]};T(Object.assign(Object.assign({awemeId:e,isReplyComment:d,shouldOptimizeReply:I,isCommentRedesign:u},n),{teaParams:Object.assign(Object.assign({},i),{play_mode:"browser_mode",enter_method:t})}))}}),[O,e,T,i]),te=null!==R&&!U,ie=(0,o.useCallback)((e=>t=>{O||13!==t.keyCode&&32!==t.keyCode||(t.stopPropagation(),t.preventDefault(),ee(e)())}),[O,ee]),ae=(0,o.useCallback)((e=>{I?P(e):L(e)}),[I]),oe=(0,o.useCallback)((()=>{ae(!0),h()}),[h]),ne=(0,o.useCallback)((()=>{ae(!1),m(),le.E.handleCloseText({group_id:i.group_id})}),[m,i.group_id]),se=(0,o.useCallback)((()=>{le.E.handleEnterText({group_id:i.group_id})}),[i.group_id]),ve=(0,je.i)({upHandler:w,downHandler:C,confirmHandler:X});(0,o.useEffect)((()=>{const e=()=>{U&&F(!1),E(!0)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}}),[U,E]);const{pathname:fe}=(0,n.useLocation)(),xe=(0,he.Fj)(fe);return(0,a.jsxs)(Ye.eX,{isReply:d,children:[(0,a.jsx)(Ye.FS,{children:(0,a.jsxs)(Ye.uI,{isInVideoDetail:xe,isFocus:I?S:A,onKeyDown:ve,onFocus:oe,onBlur:ne,onClick:se,children:[(0,a.jsx)(Ye.u_,{isInVideoDetail:xe,children:q?(0,a.jsx)(be,{isReply:d,ref:M,disable:t,onKeywordChange:z,onPost:ee("input"),onInputTrigger:V}):null}),p?(0,a.jsx)(K,{keyword:R,setIsActive:e=>{var t;z(e?null!=R?R:"":null),e&&(null===(t=M.current)||void 0===t||t.handleInsertMentionTrigger())},onSelectUser:e=>{var t;return null===(t=M.current)||void 0===t?void 0:t.handleSelectUser(e)},teaParams:i}):(0,a.jsx)(de.m,{fullscreenAdjust:!0,overlay:W("comment_tray_at"),children:(0,a.jsx)(Ye.az,{"aria-label":W("comment_tray_at"),"aria-expanded":te,role:"button",isInVideoDetail:xe,onClick:G,onKeyDown:H,tabIndex:0,children:(0,a.jsx)(s.A,{})})}),p?(0,a.jsx)(re,{onClickOpenEmojiPanel:Q,onSelectEmoji:Y,teaParams:i}):(0,a.jsx)(de.m,{fullscreenAdjust:!0,overlay:W("comment_tray_emoji"),children:(0,a.jsx)(Ye.gI,{"aria-label":W("comment_tray_emoji"),"aria-expanded":U,role:"button",isInVideoDetail:xe,isActive:U,onClick:Q,onKeyDown:Z,tabIndex:0,children:(0,a.jsx)(r.A,{})})}),!p&&te?(0,a.jsx)(Ye.Nm,{"data-e2e":"comment-at-user",show:k.length>0,children:(0,a.jsx)(Xe,{keyword:R,onSelect:X})}):null,!p&&U?(0,a.jsx)(Ye.To,{"data-e2e":"comment-emoji-list",ref:B,onKeyDown:J,children:(0,a.jsx)(Se,{onSelect:Y})}):null]})}),(0,a.jsx)(Ye.gC,{isReply:d,"aria-disabled":O,"aria-label":W("comment_tray_btn"),role:"button",isInVideoDetail:xe,isActive:!O,onClick:ee("button"),onKeyDown:ie("button"),tabIndex:0,children:W("comment_tray_btn")}),d&&(0,a.jsx)(Ye.EX,{onClick:g,isInVideoDetail:xe,children:(0,a.jsx)(Qe.g,{size:20})})]})}))},34251:(e,t,i)=>{i.d(t,{EX:()=>b,FS:()=>s,Nm:()=>p,To:()=>j,az:()=>m,eX:()=>n,gC:()=>g,gI:()=>h,uI:()=>c,u_:()=>d});var a=i(62186),o=i(72153);const n=(0,a.default)("div",{target:"e1rzzhjk0"})((({isReply:e})=>({display:"flex",flexDirection:"row",alignItems:"flex-end",marginBottom:e?"16px":""})),"label:DivCommentInputContainer;"),s=(0,a.default)("div",{target:"e1rzzhjk1"})({flex:"1 1 auto"},"label:DivLayoutContainer;"),r="48px",l="39px",c=(0,a.default)("div",{target:"e1rzzhjk2"})((({theme:{colors:e},isFocus:t,isInVideoDetail:i})=>[{position:"relative",display:"flex",flexDirection:"row",alignItems:"end",backgroundColor:e.BGInput,boxSizing:"border-box",border:"1px solid",borderColor:t?e.LinePrimary:"transparent",borderRadius:8,padding:i?"0 9px 0 16px":"0 9px",cursor:"text"}]),"label:DivInputAreaContainer;");c.defaultProps=Object.assign(Object.assign({},c.defaultProps),{"data-e2e":"comment-input"});const d=(0,a.default)("div",{target:"e1rzzhjk3"})((({isInVideoDetail:e=!1})=>({flex:"1 1 auto",height:"auto",margin:e?"11px 0":"10px 0",marginInlineEnd:"8px",alignSelf:"center",":has(> .multiline-input)":{alignSelf:"end"}})),"label:DivInputEditorContainer;");function u({theme:e,isActive:t=!1,isInVideoDetail:i=!1}){return[{flex:"0 0 32px",width:32,height:32,padding:5,margin:i?"7px 3px":3,cursor:"pointer",backgroundColor:t?e.colors.ShadowPrimary:"transparent",borderRadius:8,":hover":{backgroundColor:e.colors.ShadowPrimary},svg:{width:"100%",height:"100%"}}]}d.defaultProps=Object.assign(Object.assign({},d.defaultProps),{"data-e2e":"comment-text"});const m=(0,a.default)("div",{target:"e1rzzhjk4"})(u,"label:DivMentionButton;");m.defaultProps=Object.assign(Object.assign({},m.defaultProps),{"data-e2e":"comment-at-icon"});const h=(0,a.default)("div",{target:"e1rzzhjk5"})(u,"label:DivEmojiButton;");h.defaultProps=Object.assign(Object.assign({},h.defaultProps),{"data-e2e":"comment-emoji-icon"});const g=(0,a.default)("div",{target:"e1rzzhjk6"})((({theme:e,isActive:t,isInVideoDetail:i=!1})=>[(0,o.zy)({theme:e,color:t?"Primary":"TextQuaternary",typography:"H6",fontWeight:"semiBold"}),{cursor:t?"pointer":"default",flex:"0 0 48px",fontSize:i?"16px":"14px",lineHeight:i?r:l,textAlign:(0,o.t7)(e.direction,"end")},({isReply:t})=>(0,o.mp)({direction:e.direction,marginEnd:t?16:4})]),"label:DivPostButton;");g.defaultProps=Object.assign(Object.assign({},g.defaultProps),{"data-e2e":"comment-post"});const p=(0,a.default)("div",{target:"e1rzzhjk7"})((({show:e,theme:{colors:t,direction:i}})=>[{position:"absolute",zIndex:1,width:280,height:256,top:-256,borderRadius:8,overflow:"hidden",backgroundColor:t.BGPrimary,boxShadow:`${t.ShadowPrimary} 0px 4px 16px 0px`,display:e?"block":"none"},(0,o.mp)({direction:i,start:44})]),"label:DivMentionSuggestionContainer;"),j=(0,a.default)("div",{target:"e1rzzhjk9"})((({theme:{colors:e,direction:t}})=>[{position:"absolute",width:368,height:300,top:-300,borderRadius:8,overflow:"hidden",backgroundColor:e.BGPrimary,boxShadow:`${e.ShadowPrimary} 0px 4px 16px 0px`,outline:0,zIndex:1},(0,o.mp)({direction:t,end:12})]),"label:DivEmojiPanelContainer;"),b=(0,a.default)("div",{target:"e1rzzhjk10"})((({isInVideoDetail:e,theme:t})=>({cursor:"pointer",display:"flex",alignItems:"center",height:e?r:l,color:t.colors.TextPrimary})),"label:DivCloseBtn;")},94901:(e,t,i)=>{i.d(t,{Ky:()=>c,T1:()=>s,_4:()=>d,mM:()=>n});var a=i(62186),o=i(72153);const n=(0,a.default)("div",{target:"ekjxngi0"})((({noBorderTop:e,noBackgroundColor:t,theme:i,overflowVisible:a,inDetailPage:o=!1})=>({width:"100%",boxSizing:"border-box",backgroundColor:t?"":i.colors.BGCreation3,borderTop:e?"none":`1px solid ${i.colors.LinePrimary2}`,borderBottom:o?"none":`1px solid ${i.colors.LinePrimary2}`,overflowY:a?"visible":"hidden",overflowX:a?"visible":"hidden",flexGrow:1,position:"relative",paddingBottom:o?"30px":"",display:"flex",flexDirection:"column"})),"label:DivCommentContainer;"),s=(0,a.default)("div",{target:"ekjxngi2"})((({theme:e,marginTop:t})=>[(0,o.zy)({theme:e,typography:"P3",fontWeight:"normal",color:"TextTertiary"}),{marginTop:t?"40px":0,width:"100%",padding:"0 16px",boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center"}]),"label:DivEmpty;"),r="32px",l="24px",c=(0,a.default)("div",{target:"ekjxngi3"})((({inDetailPage:e=!1,shouldOptimizeCta:t,overflowVisible:i,seoExpVidGroup:a})=>Object.assign({width:"100%",overflowY:i?"visible":"auto",overflowX:i?"visible":"hidden",flexGrow:1,position:"relative",padding:e?"0 0 24px":`0 ${t?l:r} 24px`,":first-of-type":{paddingTop:"24px"}},"v2"===a?{display:"none"}:{})),"label:DivCommentListContainer;"),d=(0,a.default)("div",{target:"ekjxngi4"})((({shouldOptimizeCta:e})=>[{marginLeft:`-${e?l:r}`,marginRight:`-${e?l:r}`}]),"label:DivProfileWrapper;")},43223:(e,t,i)=>{i.d(t,{DL:()=>g,HW:()=>p,dp:()=>m,sk:()=>h});var a=i(40099),o=i(93608),n=i(65365),s=i(98910),r=i(60072),l=i(48868),c=i(84908),d=i(32125),u=i(57431);function m({itemId:e,cid:t,onShow:i}){var a;const{language:o}=(0,u.x)(),n=(0,r.F3)((t=>{var i,a;return null!==(a=null===(i=t[e])||void 0===i?void 0:i.author)&&void 0!==a?a:""}),d.bN),m=(0,l.Tq)((e=>e[t]),d.bN),h=(0,c.nW)((e=>{var t,i;return null===(i=e.users[null!==(t=null==m?void 0:m.user)&&void 0!==t?t:""])||void 0===i?void 0:i.secUid}),d.bN),g=(0,r.F3)((t=>t[e]),d.bN),p=(0,c.nW)((e=>{var t;return e.users[null!==(t=null==g?void 0:g.author)&&void 0!==t?t:""]}),d.bN),{handleShowReport:j}=(0,s.Ah)({onShow:i,reportTarget:{lang:o,report_type:"comment",comment_with_emoji:/\[(\w+)\]/g.test(null!==(a=null==m?void 0:m.text)&&void 0!==a?a:"")?1:0,object_id:t,owner_id:null!=h?h:"",object_owner_id:null!=h?h:"",video_owner_id:n,video_id:e,video_owner:p}});return j}function h(){return{handleShowReport:(0,a.useCallback)((({word:e,id:t,wordId:i,logId:a,searchPosition:s,enterFrom:r})=>{const l={search_position:s,video_page_type:"browser_mode",enter_group_id:t,enter_from:r,words_source:"comment_related_search",previous_page:o.f.commonParams.previous_page,impr_id:null!=a?a:""};n.$G.handleTrendingShow(Object.assign({words_num:1,raw_query:""},l)),n.$G.handleTrendingWordsShow(Object.assign({words_content:e,words_position:0,group_id:i,words_type:""},l))}),[]),handleClickReport:(0,a.useCallback)((({word:e,id:t,wordId:i,logId:a,searchPosition:s,enterFrom:r})=>{n.$G.handleTrendingWordsClick({enter_from:r,words_source:"comment_related_search",words_content:e,previous_page:o.f.commonParams.previous_page,words_position:0,enter_group_id:t,group_id:i,impr_id:null!=a?a:"",words_type:"",search_position:s,video_page_type:"browser_mode"})}),[])}}function g(){return{handleShowReport:(0,a.useCallback)((({id:e,word:t,wordId:i})=>{n.$G.handleCommentRelatedSearchBoardShow({enter_group_id:e,board_type:"pc",group_id:i,words_content:t})}),[]),handleClickReport:(0,a.useCallback)((({id:e,word:t,wordId:i,detail:a})=>{n.$G.handleCommentRelatedSearchBoardClick({enter_group_id:e,board_type:"pc",group_id:i,words_content:t,click_detail:a})}),[])}}function p(){return{handleShowReport:(0,a.useCallback)((e=>{const{words_content:t,comment_id:i,enter_group_id:a,video_page_type:s,impr_id:r,group_id:l,search_position:c,enter_from:d}=e;n.$G.handleTrendingWordsShow({enter_from:d,search_position:c,words_source:"comment_highlighted_words",words_content:t,previous_page:o.f.commonParams.previous_page,comment_id:i,enter_group_id:a,video_page_type:s,page_name:o.f.commonParams.page_name,impr_id:r,group_id:l})}),[]),handleClickReport:(0,a.useCallback)((e=>{const{words_content:t,comment_id:i,enter_group_id:a,video_page_type:s,impr_id:r,group_id:l,search_position:c,enter_from:d}=e;n.$G.handleTrendingWordsClick({enter_from:d,search_position:c,video_page_type:s,words_source:"comment_highlighted_words",words_content:t,enter_group_id:a,previous_page:o.f.commonParams.previous_page,comment_id:i,page_name:o.f.commonParams.page_name,impr_id:r,group_id:l})}),[])}}},62413:(e,t,i)=>{i.d(t,{E:()=>o});var a=i(93608);const o={handleEnterText:e=>{a.f.sendEvent("enter_text",e)},handleCloseText:e=>{a.f.sendEvent("close_text",e)}}},65329:(e,t,i)=>{i.d(t,{A:()=>a});const a=[{emoji:"ğŸ˜€",alias:"grinning"},{emoji:"ğŸ˜ƒ",alias:"smiley"},{emoji:"ğŸ˜„",alias:"smile"},{emoji:"ğŸ˜",alias:"grin"},{emoji:"ğŸ˜†",alias:"laughing"},{emoji:"ğŸ˜…",alias:"sweat_smile"},{emoji:"ğŸ¤£",alias:"rofl"},{emoji:"ğŸ˜‚",alias:"joy"},{emoji:"ğŸ™‚",alias:"slightly_smiling_face"},{emoji:"ğŸ™ƒ",alias:"upside_down_face"},{emoji:"ğŸ˜‰",alias:"wink"},{emoji:"ğŸ˜Š",alias:"blush"},{emoji:"ğŸ˜‡",alias:"innocent"},{emoji:"ğŸ˜",alias:"heart_eyes"},{emoji:"ğŸ˜˜",alias:"kissing_heart"},{emoji:"ğŸ˜—",alias:"kissing"},{emoji:"ğŸ˜š",alias:"kissing_closed_eyes"},{emoji:"ğŸ˜™",alias:"kissing_smiling_eyes"},{emoji:"ğŸ˜‹",alias:"yum"},{emoji:"ğŸ˜›",alias:"stuck_out_tongue"},{emoji:"ğŸ˜œ",alias:"stuck_out_tongue_winking_eye"},{emoji:"ğŸ˜",alias:"stuck_out_tongue_closed_eyes"},{emoji:"ğŸ¤‘",alias:"money_mouth_face"},{emoji:"ğŸ¤—",alias:"hugs"},{emoji:"ğŸ¤”",alias:"thinking"},{emoji:"ğŸ¤",alias:"zipper_mouth_face"},{emoji:"ğŸ˜",alias:"neutral_face"},{emoji:"ğŸ˜‘",alias:"expressionless"},{emoji:"ğŸ˜¶",alias:"no_mouth"},{emoji:"ğŸ˜",alias:"smirk"},{emoji:"ğŸ˜’",alias:"unamused"},{emoji:"ğŸ™„",alias:"roll_eyes"},{emoji:"ğŸ˜¬",alias:"grimacing"},{emoji:"ğŸ¤¥",alias:"lying_face"},{emoji:"ğŸ˜Œ",alias:"relieved"},{emoji:"ğŸ˜”",alias:"pensive"},{emoji:"ğŸ˜ª",alias:"sleepy"},{emoji:"ğŸ¤¤",alias:"drooling_face"},{emoji:"ğŸ˜´",alias:"sleeping"},{emoji:"ğŸ˜·",alias:"mask"},{emoji:"ğŸ¤’",alias:"face_with_thermometer"},{emoji:"ğŸ¤•",alias:"face_with_head_bandage"},{emoji:"ğŸ¤¢",alias:"nauseated_face"},{emoji:"ğŸ¤§",alias:"sneezing_face"},{emoji:"ğŸ˜µ",alias:"dizzy_face"},{emoji:"ğŸ¤ ",alias:"cowboy_hat_face"},{emoji:"ğŸ˜",alias:"sunglasses"},{emoji:"ğŸ¤“",alias:"nerd_face"},{emoji:"ğŸ˜•",alias:"confused"},{emoji:"ğŸ˜Ÿ",alias:"worried"},{emoji:"ğŸ™",alias:"slightly_frowning_face"},{emoji:"ğŸ˜®",alias:"open_mouth"},{emoji:"ğŸ˜¯",alias:"hushed"},{emoji:"ğŸ˜²",alias:"astonished"},{emoji:"ğŸ˜³",alias:"flushed"},{emoji:"ğŸ˜¦",alias:"frowning"},{emoji:"ğŸ˜§",alias:"anguished"},{emoji:"ğŸ˜¨",alias:"fearful"},{emoji:"ğŸ˜°",alias:"cold_sweat"},{emoji:"ğŸ˜¥",alias:"disappointed_relieved"},{emoji:"ğŸ˜¢",alias:"cry"},{emoji:"ğŸ˜­",alias:"sob"},{emoji:"ğŸ˜±",alias:"scream"},{emoji:"ğŸ˜–",alias:"confounded"},{emoji:"ğŸ˜£",alias:"persevere"},{emoji:"ğŸ˜",alias:"disappointed"},{emoji:"ğŸ˜“",alias:"sweat"},{emoji:"ğŸ˜©",alias:"weary"},{emoji:"ğŸ˜«",alias:"tired_face"},{emoji:"ğŸ˜¤",alias:"triumph"},{emoji:"ğŸ˜¡",alias:"rage"},{emoji:"ğŸ˜ ",alias:"angry"},{emoji:"ğŸ˜ˆ",alias:"smiling_imp"},{emoji:"ğŸ‘¿",alias:"imp"},{emoji:"ğŸ’€",alias:"skull"},{emoji:"ğŸ’©",alias:"hankey"},{emoji:"ğŸ¤¡",alias:"clown_face"},{emoji:"ğŸ‘¹",alias:"japanese_ogre"},{emoji:"ğŸ‘º",alias:"japanese_goblin"},{emoji:"ğŸ‘»",alias:"ghost"},{emoji:"ğŸ‘½",alias:"alien"},{emoji:"ğŸ‘¾",alias:"space_invader"},{emoji:"ğŸ¤–",alias:"robot"},{emoji:"ğŸ˜º",alias:"smiley_cat"},{emoji:"ğŸ˜¸",alias:"smile_cat"},{emoji:"ğŸ˜¹",alias:"joy_cat"},{emoji:"ğŸ˜»",alias:"heart_eyes_cat"},{emoji:"ğŸ˜¼",alias:"smirk_cat"},{emoji:"ğŸ˜½",alias:"kissing_cat"},{emoji:"ğŸ™€",alias:"scream_cat"},{emoji:"ğŸ˜¿",alias:"crying_cat_face"},{emoji:"ğŸ˜¾",alias:"pouting_cat"}]}}]);