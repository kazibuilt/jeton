"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4716],{96754:(e,t,o)=>{o.d(t,{rS:()=>b,sK:()=>x,HQ:()=>h,x6:()=>y});var n=o(57431),i=o(40040),l=o(44630),a=o(60072),c=o(39228),s=o(26325),r=o(14374),d=o(71111),u=o(31209),v=o(87934);const p=(0,o(51264).l)("/api/collection/move_items/",{statusCode:0});var g=function(e,t,o,n){return new(o||(o=Promise))((function(i,l){function a(e){try{s(n.next(e))}catch(e){l(e)}}function c(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))};const m={statusCode:0,loading:!1,hasMore:!0,collectionList:[],total:"0"},f=(0,r._)((0,d.atom)(m),{rehydrationKey:"desktop.userPage.userCollectionList"});f.debugLabel="collectionInfoListAtom";const{useAtomService:h,useServiceDispatchers:x,useServiceState:y,getStaticApi:b}=(0,u.i)(f,((e,t)=>({getCollectionInfoList(o){return g(this,void 0,void 0,(function*(){const{secUid:a,isReset:r=!1}=o;try{t(f,(e=>Object.assign(Object.assign({},e),{loading:!0})));const{user:o}=(0,n.x)(),d=Object.assign(Object.assign({},(0,l.bv)(e,f,{secUid:a})),{appId:i.xE,publicOnly:(null==o?void 0:o.secUid)!==a});r&&(d.cursor="0");const u=yield function(e){return g(this,void 0,void 0,(function*(){return c.hd.get("/api/user/collection_list/",{query:e,baseUrlType:2,headers:{[s.nk]:c.hd.csrfToken}})}))}(d);t(f,(e=>{var t,o;if(r)return Object.assign(Object.assign(Object.assign({},e),u),{loading:!1});const n=[...null!==(t=e.collectionList)&&void 0!==t?t:[]],i=new Set(n.map((e=>e.collectionId)));for(const e of null!==(o=u.collectionList)&&void 0!==o?o:[])i.has(e.collectionId)||(i.add(e.collectionId),n.push(e));return Object.assign(Object.assign(Object.assign({},e),u),{collectionList:n,loading:!1})}))}catch(e){t(f,(e=>Object.assign(Object.assign({},e),{loading:!1,statusCode:-1})))}}))},resetCollectionInfoList(){t(f,Object.assign({},m))},moveItems({itemIds:o,fromCollectionId:n,targetCollectionId:i,onMove:l}){var c,s,r,d,u,m,h;return g(this,void 0,void 0,(function*(){if(0===o.length)return;const g=e(f),x=null===(c=g.collectionList)||void 0===c?void 0:c.find((e=>e.collectionId===n)),y=null===(s=g.collectionList)||void 0===s?void 0:s.find((e=>e.collectionId===i)),b=null!==(r=null==x?void 0:x.total)&&void 0!==r?r:"0",C=(BigInt(b)-BigInt(o.length)).toString(),_=null!==(d=null==y?void 0:y.total)&&void 0!==d?d:"0",I=(BigInt(_)+BigInt(o.length)).toString(),j=null===(h=null===(m=null===(u=e(a.Pu)[o[0]])||void 0===u?void 0:u.video)||void 0===m?void 0:m.zoomCover)||void 0===h?void 0:h[240],w="0"===C||null==x?void 0:x.cover,k=!(null==y?void 0:y.cover)&&j?{urlList:[j]}:null==y?void 0:y.cover;let O;if(n)i?(this.modifyCollectionInfo(n,{total:C,cover:w}),this.modifyCollectionInfo(i,{total:I,cover:k}),O=t(p,{itemIDs:o.join(","),fromCollectionID:n,targetCollectionID:i})):(this.modifyCollectionInfo(n,{total:C,cover:w}),O=t(v.m,{collectionId:n,deleteIds:o.join(",")}));else{if(!i)return;this.modifyCollectionInfo(i,{total:I,cover:k}),O=t(v.m,{collectionId:i,commitIds:o.join(",")})}const{statusCode:T}=yield O;0!==T&&(n&&this.modifyCollectionInfo(n,{total:b,cover:null==x?void 0:x.cover}),i&&this.modifyCollectionInfo(i,{total:_,cover:null==y?void 0:y.cover})),null==l||l({statusCode:T,fromCollection:x,targetCollection:y})}))},prependCollectionInfo(o){var n;(null===(n=e(f).collectionList)||void 0===n?void 0:n.some((e=>e.collectionId===o.collectionId)))||t(f,(e=>{var t;return Object.assign(Object.assign({},e),{collectionList:[o,...null!==(t=e.collectionList)&&void 0!==t?t:[]]})}))},modifyCollectionInfo(o,n){const i=e(f);if(!i.collectionList)return;const l=i.collectionList.findIndex((e=>e.collectionId===o));if(l<0)return;const a=[...i.collectionList];a[l]=Object.assign(Object.assign({},a[l]),n),t(f,(e=>Object.assign(Object.assign({},e),{collectionList:a})))}})))},51264:(e,t,o)=>{o.d(t,{l:()=>r});var n=o(39228),i=o(26325),l=o(57431),a=o(89049),c=o(28086),s=function(e,t,o,n){return new(o||(o=Promise))((function(i,l){function a(e){try{s(n.next(e))}catch(e){l(e)}}function c(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))};function r(e,t){return(0,c.z)({initState:t,fetchAction:(o,c,r)=>s(this,void 0,void 0,(function*(){try{const{user:t,language:o}=(0,l.x)(),s=yield n.hd.post(e,{query:Object.assign(Object.assign({},c),{aid:a.xE,region:null==t?void 0:t.region,language:o}),baseUrlType:2,headers:{[i.nk]:n.hd.csrfToken}});return null==r||r(s),s}catch(e){const o=Object.assign(Object.assign({},t),{statusCode:-1});return null==r||r(o),o}}))})}},70911:(e,t,o)=>{o.d(t,{e:()=>n});const n=(0,o(51264).l)("/api/collection/create/",{collectionId:0,collectionIdString:"",statusCode:0})},87934:(e,t,o)=>{o.d(t,{m:()=>n});const n=(0,o(51264).l)("/api/collection/modify_items/",{statusCode:0})},72781:(e,t,o)=>{o.d(t,{o:()=>l,s:()=>i});var n=o(40099);function i(e){const t=(0,n.useCallback)(((t,o)=>{o&&(o.preventDefault(),o.stopPropagation()),t.disabled||(t.preventCloseOnClick||null==e||e(!1),t.action())}),[e]),o=(0,n.useCallback)(((e,o)=>{o.target instanceof HTMLInputElement||"Enter"!==o.code&&"Space"!==o.code||(o.preventDefault(),o.stopPropagation(),t(e,o))}),[t]);return{handleAction:t,handleKeyDown:o}}function l({controlledOpen:e,onControlledOpenChange:t}){const[o,i]=(0,n.useState)(!1),l=null!=e?e:o,a=(0,n.useCallback)((e=>{i(e),null==t||t(e)}),[t]);return[l,a]}},41428:(e,t,o)=>{function n(e){if(!e.state||!e.states||!e.states[e.state])return e;const t=e.states[e.state];return Object.assign(Object.assign({},e),t)}o.d(t,{Z:()=>n})},24716:(e,t,o)=>{o.d(t,{e:()=>J});var n=o(24643),i=o(40099),l=o(27535),a=o(67518),c=o(58542),s=o(57431),r=o(25616),d=o(32125),u=o(96754),v=o(93608),p=o(28086),g=o(70911),m=o(50299),f=o(58180);const h=(0,i.memo)((function({disabled:e,onCreate:t,playModeForTea:o}){const[,l]=(0,p.I)(g.e,{resetStateBeforeDispatch:!0}),[a,s]=(0,u.HQ)((e=>{var t;return BigInt(null!==(t=e.total)&&void 0!==t?t:0)>0})),[d,h]=(0,i.useState)(!1),[x,y]=(0,i.useState)(""),[b,C]=(0,i.useState)(!1),_=(0,r.s)(),I=(0,m.Z)(),j=(0,i.useCallback)((({statusCode:e,collectionIdString:n})=>{0===e&&n?(h(!1),v.f.sendEvent("collection_create_success",{video_selection:"did_not_select",play_mode:o}),s.prependCollectionInfo({collectionId:n,name:x,status:b?3:1,total:"0"}),null==t||t(n)):I({success:!1})}),[o,s,x,b,t,I]),w=(0,i.useCallback)((()=>{return e=this,t=void 0,i=function*(){v.f.sendEvent("name_collection",{make_public:b?1:0,enter_method:"popup_modal",play_mode:o}),yield l({collectionName:x.trim(),collectionStatus:b?3:1},j)},new((n=void 0)||(n=Promise))((function(o,l){function a(e){try{s(i.next(e))}catch(e){l(e)}}function c(e){try{s(i.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((i=i.apply(e,t||[])).next())}));var e,t,n,i}),[x,b,l,j,o]),k=(0,i.useCallback)((()=>{y(""),C(!1),h(!0),v.f.sendEvent("create_collection",{enter_method:"popup_modal",has_collections:a?1:0,play_mode:o})}),[a,o]),O=(0,i.useCallback)((e=>{h(e),e||v.f.sendEvent("close_create_collection",{stage:"naming stage",play_mode:o})}),[o]);return(0,n.jsxs)("div",{children:[(0,n.jsx)(c.I05,{leadingIcon:(0,n.jsx)(c.l$J,{}),label:_("create_new_collection_btn"),size:"medium",variant:"secondary",onClick:k,"data-e2e":"collection-action-create","aria-label":_("create_new_collection_btn"),disabled:e,tabIndex:0}),(0,n.jsx)(f.k,{open:d,onOpenChange:O,name:x,onNameChange:y,isPublic:b,onIsPublicChange:C,onNext:w,nextText:_("save_collection_btn")})]})}));var x=o(2584),y=o(60072),b=o(58791),C=o(26290),_=o(62186),I=o(72781),j=o(41428);const w=o(75431).AH`
  opacity: 0.4;
  cursor: not-allowed !important;
`,k=(0,_.default)(c.KhS,{target:"e12guzic0"})((()=>({height:"var(--popover-item-height) !important","& > .TUXMenuItem-iconContainer":{fontSize:"22px"}})),(({disabled:e})=>e&&w),"label:PopoverActionItem;"),O=(0,_.default)(k,{target:"e12guzic1"})((()=>({cursor:"auto !important",pointerEvents:"none",backgroundColor:c.Tj4.UISheetFlat3})),"label:PopoverTitle;"),T=(0,_.default)(c.KhS,{target:"e12guzic2"})((()=>[w,{"&:hover":{backgroundColor:"unset !important"}}]),"label:EmptyItem;"),L=(0,i.memo)((function({title:e,overflow:t,initialVisibleItems:o,actionOptions:s,open:d,onOpenChange:u,e2eTag:v="action",placement:p,onShowMore:g,trigger:m,itemHeight:f=50,emptyContent:h,style:x,className:y}){const[b,_]=(0,i.useState)(!1),w=(0,i.useRef)(!1),L=(0,r.s)(),{zIndex:M}=(0,a.u)(),[S,P]=(0,I.o)({controlledOpen:d,onControlledOpenChange:u}),[E]=(0,l.Wx)({threshold:1,triggerOnce:!0,onChange:e=>e&&(null==g?void 0:g())}),U=(0,i.useMemo)((()=>(("scroll"===t?.5:1)+o)*f),[o,f,t]),F=(0,i.useMemo)((()=>{const t=U+(e?1:0)*f+8;return Object.assign({maxHeight:t,padding:4,overflowY:"auto",overflowX:"hidden",zIndex:M.overlay-50,"--popover-item-height":`${f}px`},x)}),[f,U,x,e,M.overlay]),D=(0,i.useMemo)((()=>"expand"===t?b?s.slice(o):s.slice(0,o):s),[s,o,t,b]),{handleAction:N,handleKeyDown:z}=(0,I.s)();return(0,i.useEffect)((()=>{w.current&&!S&&setTimeout((()=>{_(!1)}),300),w.current=S}),[S]),(0,n.jsxs)(c.nb1,{"data-e2e":`${v}-group`,trigger:m,open:S,onOpenChange:P,style:F,className:y,placement:p,children:[e&&!b&&(0,n.jsx)(O,{"data-e2e":`${v}-title`,tabIndex:-1,height:f,preventCloseOnClick:!0,children:e}),"expand"===t&&b&&(0,n.jsx)(k,{"data-e2e":`${v}-less`,leadingIcon:(0,n.jsx)(c.pdK,{autoMirror:!0}),onClick:()=>_(!1),preventCloseOnClick:!0,children:L("Back")}),D.map((e=>{const t=(0,j.Z)(e),i=s.findIndex((e=>e.key===t.key))===o,l=(0,n.jsx)("div",{ref:i?E:void 0,children:(0,n.jsx)(k,{"data-e2e":`${v}-${t.key}`,leadingIcon:t.icon,onClick:()=>N(t),onKeyDown:e=>z(t,e),preventCloseOnClick:t.preventCloseOnClick||t.disabled,disabled:t.disabled,children:t.title},t.key)},t.key);return t.tooltip?(0,n.jsx)(c.N0Y,{content:t.tooltip,variant:"secondary",children:l},t.key):l})),0===D.length&&h&&(0,n.jsx)(T,{"data-e2e":`${v}-empty`,preventCloseOnClick:!0,children:(0,n.jsx)(C.F.P2,{as:"div",weight:"normal",align:"center",children:h})}),"expand"===t&&!b&&(0,n.jsx)(k,{"data-e2e":`${v}-more`,leadingIcon:(0,n.jsx)(c.sLX,{}),onClick:()=>_(!0),preventCloseOnClick:!0,children:L("more")})]})})),M=(0,_.default)("div",{target:"eo1wjyw0"})((()=>({height:"42.667px",width:"32px",borderRadius:"6px"})),"label:DivCoverContainer;"),S=(0,_.default)("div",{target:"eo1wjyw1"})((({$loading:e})=>({display:"flex",gap:"12px",aligItems:"center",pointerEvents:e?"none":"auto","& > div:nth-of-type(2)":{flexGrow:1,display:"flex",flexDirection:"column"}})),"label:DivCollectionOptionContainer;"),P=(0,_.default)(C.F.P1,{target:"eo1wjyw2"})((()=>({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"})),"label:TextTitle;"),E=(0,_.default)(C.F.P3,{target:"eo1wjyw3"})((()=>({display:"flex",gap:"2px",alignItems:"center"})),"label:TextSubtitle;"),U=(0,_.default)(L)`
  &::-webkit-scrollbar {
    width: 6px;
  }

  .TUXMenuItem {
    padding: 8px 12px;
    width: 240px;

    &[data-e2e='collection-title'] {
      position: fixed;
      height: auto !important;
      width: calc(100% - 16px);
      top: 0;
      left: 0;
      padding: 8px 0 2px;
      margin-block: 0;
      margin-inline: 8px;
      border-radius: 8px 8px 0 0;
      background-color: ${c.Tj4.UISheetFlat3};
      z-index: 2;

      button {
        width: 100%;
        pointer-events: auto;
      }

      & + div {
        margin-top: 52px;
      }
    }
  }
`,F=(0,_.default)("button",{target:"eo1wjyw4"})((()=>({color:c.Tj4.UITextInfoDisplay,"&:disabled, &[disabled]":{color:c.Tj4.UIShapeSecondaryMuted2,cursor:"not-allowed"}})),"label:StyledButton;");var D=o(71111),N=o(31209);const z=(0,D.atom)({activeItemId:null});z.debugLabel="collectionPopoverAtom";const{useAtomService:B}=(0,N.i)(z,((e,t)=>({showForItem(e,o){t(z,(t=>Object.assign(Object.assign({},t),{activeItemId:e,activePlayModeForTea:o})))},dismiss(){t(z,(e=>Object.assign(Object.assign({},e),{activeItemId:null,activePlayModeForTea:null})))}})));function $({itemId:e,playModeForTea:t}){const[{activeItemId:o,activePlayModeForTea:n},l]=B((e=>e),d.bN),a=(0,i.useMemo)((()=>e===o&&t===n),[o,n,e,t]),c=(0,i.useCallback)(((o,n)=>{a!==o&&(o?(l.showForItem(e,t),v.f.sendEvent("collection_popup_show",{play_mode:t})):(l.dismiss(),v.f.sendEvent("collection_popup_exit",{play_mode:t,enter_method:n?"scroll_to_next":"click"})))}),[l,a,e,t]);return(0,i.useMemo)((()=>[a,c]),[a,c])}const A=(0,i.memo)((function({itemId:e,playModeForTea:t}){const o=(0,y.F3)((t=>{var o,n;return null!==(n=null===(o=t[e])||void 0===o?void 0:o.collected)&&void 0!==n&&n})),l=(0,r.s)(),[a,s]=$({itemId:e,playModeForTea:t}),d=(0,i.useCallback)((()=>{s(!0)}),[s]);return(0,n.jsx)(F,{type:"button",onClick:d,disabled:!o||a,"aria-label":l("favorites_collection_toast_manage"),children:(0,n.jsx)(C.F.P1,{weight:"medium",children:(0,n.jsxs)(c.rxD,{alignItems:"center",children:[(0,n.jsx)("span",{children:l("favorites_collection_toast_manage")}),(0,n.jsx)(c.sJ,{autoMirror:!0})]})})})}));var H=function(e,t,o,n){return new(o||(o=Promise))((function(i,l){function a(e){try{s(n.next(e))}catch(e){l(e)}}function c(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))},K=o(24688),X=o(78662),Z=o(21367);const V=(0,_.default)("img",{target:"egz0myv0"})((()=>({width:"100%",height:"100%",objectFit:"cover",borderRadius:"6px"})),"label:ImgCover;"),W=(0,_.default)("div",{target:"egz0myv1"})((()=>({display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:c.Tj4.UIShapeNeutral3,borderRadius:"6px",width:"100%",height:"100%"})),"label:DivEmptyCover;");function R(){return(0,n.jsx)(W,{"data-e2e":"collection-empty-cover",children:(0,n.jsx)(c.xJb,{color:"UIText3",size:"22px"})})}const q=(0,i.memo)((function({cover:e,name:t}){var o;const l=Boolean(null===(o=null==e?void 0:e.urlList)||void 0===o?void 0:o.length),a=(0,i.useMemo)((()=>{var t,o;return null!==(o=null===(t=null==e?void 0:e.urlList)||void 0===t?void 0:t[0])&&void 0!==o?o:""}),[e]);return l?(0,n.jsx)(V,{src:a,alt:t}):(0,n.jsx)(R,{})})),Q=(0,i.memo)((function({collection:e,isSelected:t,loading:o}){var i,l;const a=(0,r.s)(),s=null!==(i=e.total)&&void 0!==i?i:0,d=BigInt(s)===BigInt(1)?a("collectionsProfilePage_favoritesPage_collectionSection_videoLabelSingular"):a("collectionsProfilePage_favoritesPage_collectionSection_videoLabelPlural",{d_numOfVideos:s});return(0,n.jsxs)(S,{$loading:o,children:[(0,n.jsx)(M,{children:(0,n.jsx)(q,{cover:e.cover,name:e.name})}),(0,n.jsxs)("div",{style:{overflow:"hidden"},children:[(0,n.jsx)(P,{weight:"medium",children:null!==(l=e.name)&&void 0!==l?l:""}),(0,n.jsxs)(E,{weight:"normal",color:"UITextPlaceholder",children:[1===e.status&&(0,n.jsx)(c.hN4,{}),d]})]}),t&&(o?(0,n.jsx)(c.XWZ,{size:"small",style:{width:"14px",height:"14px"}}):(0,n.jsx)(c.IuZ,{color:"UIShapePrimary"}))]})}));const J=(0,i.memo)((function({trigger:e,itemId:t,playModeForTea:o,popoverTriggerType:p="default"}){var g;const[f,C]=(0,u.HQ)((e=>e),d.bN),_=(0,i.useMemo)((()=>{var e,t;const o=null!==(t=null===(e=f.collectionList)||void 0===e?void 0:e.length)&&void 0!==t?t:0;return(0===o||o>=4)&&(f.loading||f.hasMore)}),[null===(g=f.collectionList)||void 0===g?void 0:g.length,f.hasMore,f.loading]),[I,j]=$({itemId:t,playModeForTea:o}),w=(0,r.s)(),{direction:k}=(0,a.u)(),{user:O}=(0,i.useMemo)(s.x,[]),{isLoading:T,handleClickFavorite:L}=function({itemId:e,playModeForTea:t,onOpenChange:o,popoverTriggerType:l}){const{user:a}=(0,i.useMemo)(s.x,[]),[c,d]=(0,y.l8)((t=>{var o;return null===(o=t[e])||void 0===o?void 0:o.collected})),[v,p]=(0,u.HQ)((e=>e.loading)),g=(0,r.s)(),f=(0,i.useMemo)((()=>"bottomToast"===l?"bottom":"top"),[l]),h=(0,m.Z)(f),[C,_]=(0,i.useState)(!1),I=(0,i.useMemo)((()=>g("fc_add_toast_added_to_fav")),[g]);return{isLoading:C,handleClickFavorite:(0,b.$)({actionWhenUserLoggedIn:(0,i.useCallback)((()=>{return i=this,s=void 0,u=function*(){if(c)return _(!1),o(!1),void(yield d.postCollectVideo({itemId:e}));_(!0),"default"===l&&o(!0);const[i]=yield Promise.all([d.postCollectVideo({itemId:e}),(null==a?void 0:a.secUid)&&!v&&p.getCollectionInfoList({secUid:a.secUid,isReset:!0})]);0===(null==i?void 0:i.statusCode)?h("default"===l?{success:!0,message:I}:{success:!0,message:I,trailing:(0,n.jsx)(A,{itemId:e,playModeForTea:t})}):(h({success:!1}),o(!1)),_(!1)},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{l(u.next(e))}catch(e){t(e)}}function n(e){try{l(u.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,n)}l((u=u.apply(i,s||[])).next())}));var i,s,r,u}),[I,c,v,d,e,p,o,t,l,h,null==a?void 0:a.secUid]),modalConfig:{query:{enter_method:"click_favorite",group_id:e}},sideEffect:()=>{x.O.handleGeneralClick("favorite",{group_id:e,play_mode:t})}})}}({itemId:t,playModeForTea:o,onOpenChange:j,popoverTriggerType:p}),{isLoading:M,selectedCollection:S,handleSelectCollection:P}=function({itemId:e,playModeForTea:t,isFavoriteLoading:o}){const[n]=(0,y.l8)((t=>{var o;return null===(o=t[e])||void 0===o?void 0:o.collected})),l=(0,u.sK)(),a=(0,r.s)(),c=(0,m.Z)(),[s,d]=(0,i.useState)(!1),[p,g]=(0,i.useState)(""),[f,h]=(0,i.useState)(!1),x=(0,i.useCallback)(((o,n)=>H(this,void 0,void 0,(function*(){yield l.moveItems({itemIds:[e],fromCollectionId:o,targetCollectionId:n,onMove:({statusCode:e,fromCollection:i,targetCollection:l})=>{var s,r;if(0===e){n?(v.f.sendEvent("add_vids_to_collection",{play_mode:t,enter_method:"popup_modal"}),o&&v.f.sendEvent("remove_vids_from_collection",{play_mode:t,enter_method:"click_other_collection"})):v.f.sendEvent("remove_vids_from_collection",{play_mode:t,enter_method:"click_same_collection"});const e=n?a("desktopWeb_collectionsP2_collectionName",{collectionName:null!==(r=null==l?void 0:l.name)&&void 0!==r?r:""}):a("desktopWeb_collectionsP2_removedFrom",{collectionName:null!==(s=null==i?void 0:i.name)&&void 0!==s?s:""});c({success:!0,message:e})}else c({success:!1}),g(o);d(!1)}})}))),[e,l,t,c,a]),b=(0,i.useCallback)((e=>H(this,void 0,void 0,(function*(){if(s)return;const t=p===e?"":e;g(t),d(!0),o?h(!0):yield x(p,t)}))),[s,p,o,x]);return(0,i.useEffect)((()=>{f&&!o&&(h(!1),n?x("",p):d(!1))}),[x,o,n,f,p]),(0,i.useEffect)((()=>{n||g("")}),[n]),(0,i.useEffect)((()=>{g("")}),[e]),{isLoading:s,selectedCollection:p,handleSelectCollection:b}}({itemId:t,playModeForTea:o,isFavoriteLoading:T}),[E]=(0,l.Wx)({threshold:1,delay:100,onChange:e=>e&&(null==O?void 0:O.secUid)&&!f.loading&&C.getCollectionInfoList({secUid:O.secUid})}),F=(0,i.useMemo)((()=>"browser_mode"===o?"ltr"===k?"left-start":"right-start":"ltr"===k?"right-end":"left-end"),[o,k]),D=(0,i.useCallback)((e=>{return t=this,o=void 0,i=function*(){e||j(!1)},new((n=void 0)||(n=Promise))((function(e,l){function a(e){try{s(i.next(e))}catch(e){l(e)}}function c(e){try{s(i.throw(e))}catch(e){l(e)}}function s(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(a,c)}s((i=i.apply(t,o||[])).next())}));var t,o,n,i}),[j]),N=(0,i.useMemo)((()=>{var e;return[...(null!==(e=f.collectionList)&&void 0!==e?e:[]).map((e=>{const t=e.collectionId;if(t)return{key:t,title:(0,n.jsx)(Q,{collection:e,isSelected:S===t,loading:M}),action:()=>P(t),preventCloseOnClick:!0}})).filter((e=>void 0!==e)),..._?[{key:"loading",title:(0,n.jsx)("div",{ref:E,children:(0,n.jsx)(c.sgs,{style:{width:"100%"}})}),action:()=>{},preventCloseOnClick:!0}]:[]]}),[f.collectionList,_,E,S,M,P]),z=(0,i.useCallback)((e=>{"Enter"!==e.code&&"Space"!==e.code||(e.stopPropagation(),e.preventDefault(),j(!I))}),[I,j]),B=(0,i.cloneElement)(e,{onClick:L,onKeyDown:z});return function(){const{user:e}=(0,i.useMemo)(s.x,[]),[{loading:t,hasMore:o,collectionList:n,statusCode:l},a]=(0,u.HQ)((e=>e),d.bN);(0,i.useEffect)((()=>{!t&&o&&0===(null==n?void 0:n.length)&&0===l&&(null==e?void 0:e.secUid)&&a.getCollectionInfoList({secUid:e.secUid})}),[])}(),function({isOpen:e,handleOpenChange:t}){const o=(0,Z.VP)();(0,i.useEffect)((()=>{if(e){const e=(0,K.n)((e=>{const o=e.target;((0,X.Fj)(window.location.pathname)&&o===document||o instanceof HTMLDivElement&&(o.className.includes("DivColumnListContainer")||function(e){let t=e;for(;t;){if(t.className.includes("DivBrowserModeContainer"))return!0;t=t.parentElement}return!1}(o)))&&t(!1,!0)}),200);return document.addEventListener("scroll",e,!0),()=>{document.removeEventListener("scroll",e,!0)}}}),[e,t]),(0,i.useEffect)((()=>{e&&t(!1,!0)}),[o])}({isOpen:I,handleOpenChange:j}),(0,n.jsx)(U,{trigger:(0,n.jsx)("div",{children:B}),title:(0,n.jsx)(h,{disabled:M,onCreate:P,playModeForTea:o}),actionOptions:N,overflow:"scroll",initialVisibleItems:4,placement:F,open:I,onOpenChange:D,e2eTag:"collection",style:"browser_mode"===o?{zIndex:3001}:{},itemHeight:58.66,emptyContent:w("desktopWeb_collectionsP2_noCollectionsCreated"),className:"collection-popover"})}))},58180:(e,t,o)=>{o.d(t,{k:()=>C});var n=o(24643),i=o(40099),l=o(58542),a=o(25616),c=o(50299),s=o(26325),r=o(39228),d=o(62186);const u=d.default.div`
  padding: 0 24px 24px 24px;
  display: flex;
  flex-direction: column;
  gap: ${e=>e.hasMakePublic?"20px":"4px"};
`,v=d.default.div`
  color: ${l.Tj4.UIText3};
  font-size: 12px;
  line-height: 15.6px;
  margin-top: 4px;
  font-weight: 400;
`,p=d.default.div`
  display: flex;
  flex-direction: column;
  gap: 0px;
`,g=d.default.div`
  margin-bottom: 8px;
`,m=d.default.span`
  font-size: 16px;
  line-height: 20.8px;
  font-weight: 500;
`,f=d.default.span`
  color: ${e=>e.hasError?l.Tj4.UITextDanger:l.Tj4.UIText3};
  font-size: 14px;
  line-height: 18.2px;
  font-weight: 400;
`,h=d.default.div`
  display: flex;
  align-items: center;
  font-size: 13px;
  line-height: 19.5px;
  font-weight: 500;
  word-wrap: break-word;
  color: ${l.Tj4.UITextDanger};
  min-height: 19.5px;
  margin-top: 4px;
  & > svg {
    margin-right: 4px;
  }
`,x=(0,d.default)(l.OVK)`
  align-items: center !important;
  & > .TUXSwitch-labelContainer {
    padding-top: 0 !important;
    & > .TUXSwitch-label {
      font-weight: 500 !important;
      font-size: 16px !important;
    }
  }
`,y=(0,d.default)(l.DBO)`
  margin-top: 8px;
  margin-bottom: 4px;
  & .TUXModalNavBar-title {
    font-weight: 700;
  }
`;var b=function(e,t,o,n){return new(o||(o=Promise))((function(i,l){function a(e){try{s(n.next(e))}catch(e){l(e)}}function c(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,c)}s((n=n.apply(e,t||[])).next())}))};const C=(0,i.memo)((function({open:e,onOpenChange:t,name:o,onNameChange:d,isPublic:C,onIsPublicChange:_,nextText:I,onNext:j,loading:w}){const k=(0,a.s)(),O=(0,c.Z)(),[T,L]=(0,i.useState)(!1),[M,S]=(0,i.useState)(!1),P=(0,i.useMemo)((()=>o.length>30),[o.length]),E=(0,i.useMemo)((()=>o.trim().length>0&&!P),[o,P]),U=w||M,F=(0,i.useMemo)((()=>P?k("collectionsProfilePage_favoritesPage_newModal_errorMessage"):T?k("yproject_playlist_name_toast",{name:o}):void 0),[k,o,P,T]),D=(0,i.useCallback)((()=>b(this,void 0,void 0,(function*(){let e;S(!0),d(o.trim());try{e=yield function(e){return t=this,o=void 0,i=function*(){return r.hd.get("/api/playlist/name_check",{query:{name:e},baseUrlType:2,headers:{[s.nk]:r.hd.csrfToken}})},new((n=void 0)||(n=Promise))((function(e,l){function a(e){try{s(i.next(e))}catch(e){l(e)}}function c(e){try{s(i.throw(e))}catch(e){l(e)}}function s(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(a,c)}s((i=i.apply(t,o||[])).next())}));var t,o,n,i}(o.trim())}catch(t){e={statusCode:-1,isValid:!1}}const{statusCode:t,isValid:n}=e;0===t?(n?(L(!1),j()):L(!0),S(!1)):O({success:!1,message:k("Sorry, something wrong with the server, please try again.")})}))),[k,O,d,j,o]),N=(0,i.useCallback)((e=>b(this,void 0,void 0,(function*(){E&&"Enter"===e.key&&(yield D())}))),[E,D]);return(0,i.useEffect)((()=>{L(!1)}),[o]),(0,i.useEffect)((()=>{if(e)return document.addEventListener("keydown",N,!0),()=>{document.removeEventListener("keydown",N,!0)}}),[N,e]),(0,n.jsxs)(l.nOL,{open:e,onOpenChange:t,"data-e2e":"collection-create-modal",style:{zIndex:3001},children:[(0,n.jsx)(y,{title:k("collectionsProfilePage_favoritesPage_newModal_header")}),(0,n.jsxs)(u,{hasMakePublic:void 0!==C,children:[(0,n.jsxs)(p,{children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)(g,{children:[(0,n.jsxs)(m,{children:[k("collection_name_header")," "]}),(0,n.jsxs)(f,{hasError:Boolean(P),children:["(",o.length,"/",30,")"]})]}),(0,n.jsx)(l.ZPA,{ref:t=>{e&&t&&t.focus()},hideLabel:!0,label:k("collection_name_header"),placeholder:k("collection_name_description"),value:o,onChange:d,disabled:U}),(0,n.jsx)(h,{children:F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Om6,{size:"13px"}),F]}):null})]}),void 0!==C&&_&&(0,n.jsxs)("div",{children:[(0,n.jsx)(x,{label:k("make_public_toggle"),labelPosition:"before",disabled:U,checked:C,onChange:_}),(0,n.jsx)(v,{children:k("make_public_toggle_description")})]})]}),(0,n.jsx)(l.I05,{disabled:!E,label:null!=I?I:k("Next"),variant:"primary",onClick:D,loading:U})]})]})}))},50299:(e,t,o)=>{o.d(t,{Z:()=>p});var n=o(24643),i=o(40099),l=o(67518),a=o(78448),c=o(59131),s=o(58542),r=o(25616),d=o(23237),u=o(26290);const v=o(62186).default.div`
  &.dark > .TUXBottomToast,
  &.dark > .TUXTopToast,
  & > .TUXBottomToast[data-tux-color-scheme='dark'],
  & > .TUXTopToast[data-tux-color-scheme='dark'] {
    background-color: rgba(56, 56, 56, 0.95) !important;
  }
`;function p(e="top",t=3e3){const o=(0,r.s)(),{showToast:p,toastList:g}=(0,d.n)(e),{isDark:m}=(0,l.u)();return(0,i.useCallback)((({success:l,message:r,trailing:d})=>{const f=l||r?r:o("Sorry, something wrong with the server, please try again."),h=(0,i.isValidElement)(f)?f:(0,n.jsx)(u.F.P1,{weight:"medium",children:f}),x=l?(0,n.jsx)(a.R,{color:"UIText1"}):(0,n.jsx)(c.O,{color:"UIText1"}),y="top"===e?{"data-tux-color-scheme":"dark"}:void 0;return g.forEach((e=>e.dismiss())),p((0,n.jsx)(v,{className:m?"dark":"",children:d?(0,n.jsx)(s.qaZ,Object.assign({leading:x,content:h,trailing:d},y)):(0,n.jsx)(s.Mzi,Object.assign({leading:x,content:h},y))}),{durationMs:t,hasToastComponent:!1})}),[t,m,e,p,o,g])}},58791:(e,t,o)=>{o.d(t,{$:()=>a});var n=o(40099),i=o(49057),l=o(16680);function a({actionWhenUserLoggedIn:e,modalConfig:t={},sideEffect:o,alwaysOpenLoginModal:a}){const c=(0,i.W)((()=>["user"]),[]),s=(0,l.b1)();return(0,n.useCallback)(((...n)=>{if(null==o||o(...n),(null==c?void 0:c.user)&&!a){if(!t.isLinkPhoneOrEmail)return null==e?void 0:e(...n);s.openModal(t)}else s.openModal(t)}),[e,null==c?void 0:c.user,s,t,o,a])}}}]);